import{a as K}from"./chunk-MFQCTB6K.js";import{a as G,g as J}from"./chunk-6EYLVA3C.js";import{a as H,d as L}from"./chunk-4S4SHBAA.js";import{b as N}from"./chunk-IU263WV3.js";import{b as j,f as R,i as F,k as Y,n as V,q as W}from"./chunk-HVH6PFSI.js";import{d as q}from"./chunk-VKZEWMLF.js";import{d as z,e as A,f as B}from"./chunk-OHJUE5IH.js";import{i as T,j as I}from"./chunk-3EH3MU74.js";import{Bb as m,Cb as e,Db as t,Eb as l,Pb as b,Rb as g,Sa as c,Y as p,bc as u,da as y,dc as n,ea as P,ec as f,fb as D,fc as v,ic as E,jc as k,kc as w,oa as O,oc as C,pc as x,tc as S,vb as s,wb as d}from"./chunk-HNLZOKXJ.js";import{f as M}from"./chunk-ATWMZ64T.js";function U(i,a){i&1&&(e(0,"mat-icon"),n(1,"arrow_upward"),t())}function X(i,a){i&1&&(e(0,"mat-icon"),n(1,"arrow_downward"),t())}function Z(i,a){i&1&&(e(0,"mat-icon"),n(1,"check"),t())}function $(i,a){if(i&1&&(e(0,"span",37),n(1),C(2,"number"),t(),e(3,"span",38),n(4,"\u05DE\u05E2\u05DC \u05D4\u05D4\u05E2\u05E8\u05DB\u05D4"),t()),i&2){let o=g(2);c(),v("+\u20AA",x(2,1,o.difference(),"1.0-0"))}}function ee(i,a){if(i&1&&(e(0,"span",37),n(1),C(2,"number"),t(),e(3,"span",38),n(4,"\u05DE\u05EA\u05D7\u05EA \u05DC\u05D4\u05E2\u05E8\u05DB\u05D4"),t()),i&2){let o=g(2);c(),v("-\u20AA",x(2,1,-o.difference(),"1.0-0"))}}function te(i,a){i&1&&(e(0,"span",37),n(1,"\u05DE\u05D5\u05E9\u05DC\u05DD!"),t(),e(2,"span",38),n(3,"\u05D1\u05D3\u05D9\u05D5\u05E7 \u05DB\u05DE\u05D5 \u05E9\u05D4\u05E2\u05E8\u05DB\u05EA"),t())}function ne(i,a){if(i&1&&(e(0,"div",34)(1,"div",35),s(2,U,2,0,"mat-icon")(3,X,2,0,"mat-icon")(4,Z,2,0,"mat-icon"),t(),e(5,"div",36),s(6,$,5,4)(7,ee,5,4)(8,te,4,0),t()()),i&2){let o=g();u("over",o.difference()>0)("under",o.difference()<0)("exact",o.difference()===0),c(2),d(o.difference()>0?2:o.difference()<0?3:4),c(4),d(o.difference()>0?6:o.difference()<0?7:8)}}function ie(i,a){i&1&&(l(0,"div",39),e(1,"span"),n(2,"\u05E9\u05D5\u05DE\u05E8..."),t())}function oe(i,a){i&1&&(e(0,"mat-icon"),n(1,"celebration"),t(),e(2,"span"),n(3,"\u05E1\u05D9\u05D5\u05DD!"),t())}var Q=class i{dialogRef=p(G);shoppingService=p(q);historyService=p(K);actualTotal=0;isCompleting=O(!1);isRevealed=!1;difference=S(()=>this.actualTotal<=0?0:this.actualTotal-this.shoppingService.estimatedTotal());ngOnInit(){setTimeout(()=>{this.isRevealed=!0},50)}complete(){return M(this,null,function*(){if(!(this.actualTotal<=0)){this.isCompleting.set(!0);try{let a=yield this.shoppingService.completeShopping({actualTotal:this.actualTotal}),o=yield this.historyService.getTrip(a);o&&(yield this.historyService.updatePatterns(o)),this.dialogRef.close({success:!0,tripId:a})}catch(a){console.error("Error completing shopping:",a),this.isCompleting.set(!1)}}})}cancel(){this.dialogRef.close({success:!1})}static \u0275fac=function(o){return new(o||i)};static \u0275cmp=D({type:i,selectors:[["app-completion-dialog"]],decls:65,vars:16,consts:[[1,"completion-dialog"],[1,"receipt-edge","top"],[1,"success-badge"],[1,"badge-ring"],["viewBox","0 0 52 52",1,"checkmark"],["cx","26","cy","26","r","25","fill","none",1,"checkmark-circle"],["fill","none","d","M14.1 27.2l7.1 7.2 16.7-16.8",1,"checkmark-check"],[1,"dialog-title"],[1,"dialog-subtitle"],[1,"stats-row"],[1,"stat-card","purchased"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-number"],[1,"stat-label"],[1,"stat-card","skipped"],[1,"price-section"],[1,"price-row","estimated"],[1,"price-label"],[1,"price-value"],[1,"currency"],[1,"amount"],[1,"divider-fancy"],[1,"divider-dot"],[1,"divider-line"],[1,"price-row","actual"],[1,"actual-input-wrapper"],[1,"currency-prefix"],["type","number","placeholder","0","autofocus","",1,"actual-input",3,"ngModelChange","ngModel","min"],[1,"difference-badge",3,"over","under","exact"],[1,"dialog-actions"],[1,"btn-cancel",3,"click","disabled"],[1,"btn-complete",3,"click","disabled"],[1,"receipt-edge","bottom"],[1,"difference-badge"],[1,"diff-icon"],[1,"diff-content"],[1,"diff-amount"],[1,"diff-text"],[1,"spinner"]],template:function(o,r){o&1&&(e(0,"div",0),l(1,"div",1),e(2,"div",2)(3,"div",3),y(),e(4,"svg",4),l(5,"circle",5)(6,"path",6),t()()(),P(),e(7,"h2",7),n(8,"\u05E1\u05D9\u05D5\u05DD \u05D4\u05E7\u05E0\u05D9\u05D5\u05EA"),t(),e(9,"p",8),n(10,"\u05D1\u05D5\u05D0\u05D5 \u05E0\u05E1\u05DB\u05DD \u05D0\u05EA \u05D4\u05E1\u05D9\u05D1\u05D5\u05D1!"),t(),e(11,"div",9)(12,"div",10)(13,"div",11)(14,"mat-icon"),n(15,"shopping_basket"),t()(),e(16,"div",12)(17,"span",13),n(18),t(),e(19,"span",14),n(20,"\u05E0\u05E7\u05E0\u05D5"),t()()(),e(21,"div",15)(22,"div",11)(23,"mat-icon"),n(24,"remove_shopping_cart"),t()(),e(25,"div",12)(26,"span",13),n(27),t(),e(28,"span",14),n(29,"\u05D3\u05D9\u05DC\u05D2\u05E0\u05D5"),t()()()(),e(30,"div",16)(31,"div",17)(32,"div",18)(33,"mat-icon"),n(34,"calculate"),t(),e(35,"span"),n(36,"\u05D4\u05E2\u05E8\u05DB\u05D4"),t()(),e(37,"div",19)(38,"span",20),n(39,"\u20AA"),t(),e(40,"span",21),n(41),C(42,"number"),t()()(),e(43,"div",22),l(44,"span",23)(45,"span",24)(46,"span",23),t(),e(47,"div",25)(48,"div",18)(49,"mat-icon"),n(50,"receipt_long"),t(),e(51,"span"),n(52,"\u05D1\u05E4\u05D5\u05E2\u05DC"),t()(),e(53,"div",26)(54,"span",27),n(55,"\u20AA"),t(),e(56,"input",28),w("ngModelChange",function(_){return k(r.actualTotal,_)||(r.actualTotal=_),_}),t()()()(),s(57,ne,9,8,"div",29),e(58,"div",30)(59,"button",31),b("click",function(){return r.cancel()}),n(60," \u05D1\u05D9\u05D8\u05D5\u05DC "),t(),e(61,"button",32),b("click",function(){return r.complete()}),s(62,ie,3,0)(63,oe,4,0),t()(),l(64,"div",33),t()),o&2&&(u("revealed",r.isRevealed),c(18),f(r.shoppingService.checkedCount()),c(9),f(r.shoppingService.totalCount()-r.shoppingService.checkedCount()),c(14),f(x(42,13,r.shoppingService.estimatedTotal(),"1.0-0")),c(15),E("ngModel",r.actualTotal),m("min",0),c(),d(r.actualTotal>0?57:-1),c(2),m("disabled",r.isCompleting()),c(2),u("loading",r.isCompleting()),m("disabled",r.actualTotal<=0||r.isCompleting()),c(),d(r.isCompleting()?62:63))},dependencies:[I,W,j,Y,R,V,F,J,z,B,A,H,L,N,T],styles:[`@keyframes _ngcontent-%COMP%_fadeSlideIn{0%{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}@keyframes _ngcontent-%COMP%_scaleIn{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes _ngcontent-%COMP%_checkmarkStroke{to{stroke-dashoffset:0}}@keyframes _ngcontent-%COMP%_pulse{0%,to{transform:scale(1)}50%{transform:scale(1.05)}}@keyframes _ngcontent-%COMP%_spin{to{transform:rotate(360deg)}}.completion-dialog[_ngcontent-%COMP%]{position:relative;padding:2rem 1.75rem;background:linear-gradient(180deg,var(--surface-primary) 0%,color-mix(in srgb,var(--color-primary) 3%,var(--surface-primary)) 100%);min-width:340px;max-width:420px;overflow:hidden}.completion-dialog[_ngcontent-%COMP%]:before{content:"";position:absolute;inset:0;background-image:url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noise'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%' height='100%' filter='url(%23noise)'/%3E%3C/svg%3E");opacity:.02;pointer-events:none}.receipt-edge[_ngcontent-%COMP%]{position:absolute;left:0;right:0;height:12px;background:linear-gradient(135deg,var(--surface-app) 25%,transparent 25%),linear-gradient(225deg,var(--surface-app) 25%,transparent 25%);background-size:12px 12px}.receipt-edge.top[_ngcontent-%COMP%]{top:0;background-position:0 0,6px 0}.receipt-edge.bottom[_ngcontent-%COMP%]{bottom:0;transform:rotate(180deg);background-position:0 0,6px 0}.success-badge[_ngcontent-%COMP%]{position:relative;width:72px;height:72px;margin:.5rem auto 1.25rem;animation:_ngcontent-%COMP%_scaleIn .5s cubic-bezier(.34,1.56,.64,1) .1s both}.badge-ring[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;background:linear-gradient(135deg,var(--color-success) 0%,color-mix(in srgb,var(--color-success) 80%,var(--color-secondary)) 100%);display:flex;align-items:center;justify-content:center;box-shadow:0 4px 12px color-mix(in srgb,var(--color-success) 30%,transparent),0 2px 4px color-mix(in srgb,var(--color-success) 20%,transparent),inset 0 2px #fff3}.checkmark[_ngcontent-%COMP%]{width:36px;height:36px}.checkmark-circle[_ngcontent-%COMP%]{stroke:#ffffff4d;stroke-width:2;stroke-linecap:round}.checkmark-check[_ngcontent-%COMP%]{stroke:#fff;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-dasharray:48;stroke-dashoffset:48;animation:_ngcontent-%COMP%_checkmarkStroke .4s cubic-bezier(.65,0,.45,1) .4s forwards}.dialog-title[_ngcontent-%COMP%]{font-family:var(--font-family-display);font-size:1.5rem;font-weight:700;color:var(--text-primary);text-align:center;margin:0 0 .25rem;animation:_ngcontent-%COMP%_fadeSlideIn .4s ease-out .2s both}.dialog-subtitle[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary);text-align:center;margin:0 0 1.5rem;animation:_ngcontent-%COMP%_fadeSlideIn .4s ease-out .25s both}.stats-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:.75rem;margin-bottom:1.5rem;animation:_ngcontent-%COMP%_fadeSlideIn .4s ease-out .3s both}.stat-card[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem;border-radius:12px;background:var(--surface-secondary);border:1px solid var(--border-subtle);transition:transform .2s ease,box-shadow .2s ease}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-2px);box-shadow:var(--shadow-md)}.stat-card.purchased[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--color-success) 15%,transparent);color:var(--color-success)}.stat-card.skipped[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--text-tertiary) 15%,transparent);color:var(--text-tertiary)}.stat-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:10px;display:flex;align-items:center;justify-content:center}.stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px}.stat-info[_ngcontent-%COMP%]{display:flex;flex-direction:column}.stat-number[_ngcontent-%COMP%]{font-family:var(--font-family-display);font-size:1.375rem;font-weight:700;color:var(--text-primary);line-height:1.2}.stat-label[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary)}.price-section[_ngcontent-%COMP%]{background:var(--surface-secondary);border-radius:16px;padding:1.25rem;margin-bottom:1rem;border:1px solid var(--border-subtle);animation:_ngcontent-%COMP%_fadeSlideIn .4s ease-out .35s both}.price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.price-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;color:var(--text-secondary);font-size:.9375rem}.price-label[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;opacity:.7}.price-value[_ngcontent-%COMP%]{display:flex;align-items:baseline;gap:.125rem}.price-value[_ngcontent-%COMP%]   .currency[_ngcontent-%COMP%]{font-size:1rem;color:var(--text-secondary);font-weight:500}.price-value[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-family:var(--font-family-display);font-size:1.5rem;font-weight:700;color:var(--text-secondary)}.divider-fancy[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:1rem 0}.divider-line[_ngcontent-%COMP%]{flex:1;height:1px;background:repeating-linear-gradient(90deg,var(--border-default) 0,var(--border-default) 4px,transparent 4px,transparent 8px)}.divider-dot[_ngcontent-%COMP%]{width:6px;height:6px;border-radius:50%;background:var(--border-default)}.actual-input-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.25rem;background:var(--surface-primary);border:2px solid var(--color-primary);border-radius:12px;padding:.5rem .75rem;transition:box-shadow .2s ease}.actual-input-wrapper[_ngcontent-%COMP%]:focus-within{box-shadow:0 0 0 3px color-mix(in srgb,var(--color-primary) 20%,transparent)}.currency-prefix[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600;color:var(--color-primary)}.actual-input[_ngcontent-%COMP%]{width:100px;border:none;background:transparent;font-family:var(--font-family-display);font-size:1.5rem;font-weight:700;color:var(--color-primary);text-align:end;outline:none}.actual-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.actual-input[_ngcontent-%COMP%]::-webkit-outer-spin-button, .actual-input[_ngcontent-%COMP%]::-webkit-inner-spin-button{-webkit-appearance:none;margin:0}.actual-input[_ngcontent-%COMP%]{-moz-appearance:textfield}.difference-badge[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.875rem 1rem;border-radius:12px;margin-bottom:1.5rem;animation:_ngcontent-%COMP%_scaleIn .3s cubic-bezier(.34,1.56,.64,1)}.difference-badge.over[_ngcontent-%COMP%]{background:linear-gradient(135deg,color-mix(in srgb,var(--color-error) 12%,transparent),color-mix(in srgb,var(--color-error) 8%,transparent));border:1px solid color-mix(in srgb,var(--color-error) 25%,transparent)}.difference-badge.over[_ngcontent-%COMP%]   .diff-icon[_ngcontent-%COMP%]{background:var(--color-error)}.difference-badge.over[_ngcontent-%COMP%]   .diff-amount[_ngcontent-%COMP%]{color:var(--color-error)}.difference-badge.under[_ngcontent-%COMP%]{background:linear-gradient(135deg,color-mix(in srgb,var(--color-success) 12%,transparent),color-mix(in srgb,var(--color-success) 8%,transparent));border:1px solid color-mix(in srgb,var(--color-success) 25%,transparent)}.difference-badge.under[_ngcontent-%COMP%]   .diff-icon[_ngcontent-%COMP%]{background:var(--color-success)}.difference-badge.under[_ngcontent-%COMP%]   .diff-amount[_ngcontent-%COMP%]{color:var(--color-success)}.difference-badge.exact[_ngcontent-%COMP%]{background:linear-gradient(135deg,color-mix(in srgb,var(--color-primary) 12%,transparent),color-mix(in srgb,var(--color-secondary) 8%,transparent));border:1px solid color-mix(in srgb,var(--color-primary) 25%,transparent)}.difference-badge.exact[_ngcontent-%COMP%]   .diff-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary),var(--color-secondary));animation:_ngcontent-%COMP%_pulse 1.5s ease-in-out infinite}.difference-badge.exact[_ngcontent-%COMP%]   .diff-amount[_ngcontent-%COMP%]{color:var(--color-primary)}.diff-icon[_ngcontent-%COMP%]{width:36px;height:36px;border-radius:50%;display:flex;align-items:center;justify-content:center;flex-shrink:0}.diff-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#fff;font-size:20px;width:20px;height:20px}.diff-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.125rem}.diff-amount[_ngcontent-%COMP%]{font-family:var(--font-family-display);font-size:1.125rem;font-weight:700}.diff-text[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-secondary)}.dialog-actions[_ngcontent-%COMP%]{display:flex;gap:.75rem;animation:_ngcontent-%COMP%_fadeSlideIn .4s ease-out .4s both}.btn-cancel[_ngcontent-%COMP%], .btn-complete[_ngcontent-%COMP%]{flex:1;display:flex;align-items:center;justify-content:center;gap:.5rem;padding:.875rem 1.25rem;border-radius:12px;font-family:var(--font-family-hebrew);font-size:1rem;font-weight:600;cursor:pointer;transition:all .2s ease;border:none}.btn-cancel[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .btn-complete[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.btn-cancel[_ngcontent-%COMP%]{background:var(--surface-secondary);color:var(--text-secondary);border:1px solid var(--border-default)}.btn-cancel[_ngcontent-%COMP%]:hover:not(:disabled){background:var(--surface-hover);color:var(--text-primary)}.btn-cancel[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-complete[_ngcontent-%COMP%]{background:linear-gradient(135deg,var(--color-primary) 0%,color-mix(in srgb,var(--color-primary) 85%,var(--color-secondary)) 100%);color:#fff;box-shadow:0 4px 12px color-mix(in srgb,var(--color-primary) 35%,transparent),0 2px 4px color-mix(in srgb,var(--color-primary) 25%,transparent)}.btn-complete[_ngcontent-%COMP%]:hover:not(:disabled){transform:translateY(-2px);box-shadow:0 6px 16px color-mix(in srgb,var(--color-primary) 40%,transparent),0 3px 6px color-mix(in srgb,var(--color-primary) 30%,transparent)}.btn-complete[_ngcontent-%COMP%]:active:not(:disabled){transform:translateY(0)}.btn-complete[_ngcontent-%COMP%]:disabled{opacity:.6;cursor:not-allowed;transform:none}.btn-complete.loading[_ngcontent-%COMP%]{pointer-events:none}.spinner[_ngcontent-%COMP%]{width:20px;height:20px;border:2px solid rgba(255,255,255,.3);border-top-color:#fff;border-radius:50%;animation:_ngcontent-%COMP%_spin .8s linear infinite}`]})};export{Q as a};
