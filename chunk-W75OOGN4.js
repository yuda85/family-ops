import{b as ne,c as re,e as ae,g as le}from"./chunk-KKYRDIC6.js";import{b as he}from"./chunk-R7YJ63L2.js";import{a as ue,b as ge,c as fe,d as De}from"./chunk-DBA5HZUL.js";import{a as pe,c as se}from"./chunk-T3S3PSFS.js";import{a as me,b as de,g as ce}from"./chunk-PKSSNXGP.js";import{a as te,c as ie,d as oe}from"./chunk-BFWFC2UO.js";import{a as Z,e as $,h as ee}from"./chunk-DNCMLEWE.js";import{a as L}from"./chunk-O6HJ35IU.js";import{f as N}from"./chunk-HS2XTPUM.js";import{b as G,f as H,g as J,h as K,i as Q,j as U,o as X,q as Y}from"./chunk-FSRTV3VH.js";import{d as R}from"./chunk-X4QG5DAP.js";import{a as j,b as z,d as q,e as P,f as I}from"./chunk-SXGBHULN.js";import{k as x}from"./chunk-OJNKK6II.js";import{$a as V,$b as T,Ab as S,Bb as u,Cb as r,Db as o,Eb as w,Lb as k,Pb as _,Rb as v,Sa as n,Y as y,ac as C,ba as p,bc as B,ca as s,dc as l,ec as g,fb as E,fc as M,ic as f,jc as D,kc as h,vb as W,wb as A,zb as b}from"./chunk-QZLPLYI5.js";import{f as O}from"./chunk-ATWMZ64T.js";var Ce=class m{status;get statusMeta(){return ne(this.status)}static \u0275fac=function(i){return new(i||m)};static \u0275cmp=E({type:m,selectors:[["app-status-badge"]],inputs:{status:"status"},decls:5,vars:4,consts:[[1,"status-badge"],[1,"label"]],template:function(i,e){i&1&&(r(0,"span",0)(1,"mat-icon"),l(2),o(),r(3,"span",1),l(4),o()()),i&2&&(C("--badge-color",e.statusMeta.color),n(2),g(e.statusMeta.icon),n(2),g(e.statusMeta.labelHe))},dependencies:[x,I,P],styles:[".status-badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .5rem;border-radius:9999px;font-size:.75rem;font-weight:500;background:color-mix(in srgb,var(--badge-color) 15%,transparent);color:var(--badge-color)}.status-badge[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}"]})};var F=(m,t)=>t.id;function be(m,t){if(m&1&&(r(0,"mat-option",13)(1,"mat-icon"),l(2),o(),l(3),o()),m&2){let i=t.$implicit;u("value",i.id),n(),C("color",i.color),n(),g(i.icon),n(),M(" ",i.labelHe," ")}}function Se(m,t){if(m&1&&(r(0,"mat-option",13)(1,"mat-icon"),l(2),o(),l(3),o()),m&2){let i=t.$implicit;u("value",i.id),n(),C("color",i.color),n(),g(i.icon),n(),M(" ",i.labelHe," ")}}function we(m,t){if(m&1){let i=k();r(0,"label",26)(1,"input",27),_("change",function(){let d=p(i).$implicit,c=v(2);return s(c.toggleChild(d.id))}),o(),w(2,"span",28),l(3),o()}if(m&2){let i=t.$implicit,e=v(2);B("selected",e.isChildSelected(i.id)),n(),u("checked",e.isChildSelected(i.id)),n(),C("background",i.color),n(),M(" ",i.name," ")}}function ve(m,t){if(m&1&&(r(0,"div",19)(1,"label",23),l(2,"\u05D9\u05DC\u05D3\u05D9\u05DD \u05E7\u05E9\u05D5\u05E8\u05D9\u05DD"),o(),r(3,"div",24),b(4,we,4,6,"label",25,F),o()()),m&2){let i=v();n(4),S(i.familyService.children())}}var _e=class m{constructor(t){this.data=t}topicsService=y(le);familyService=y(R);dialogRef=y(me);categories=ae;priorities=re;isEdit=!1;isSubmitting=!1;formData={title:"",description:"",category:"general",priority:"medium",targetDate:null,deadline:null,linkedChildrenIds:[]};ngOnInit(){if(this.data?.topic){this.isEdit=!0;let t=this.data.topic;this.formData={title:t.title,description:t.description,category:t.category,priority:t.priority,targetDate:t.targetDate?.toDate()||null,deadline:t.deadline?.toDate()||null,linkedChildrenIds:[...t.linkedChildrenIds]}}}isChildSelected(t){return this.formData.linkedChildrenIds.includes(t)}toggleChild(t){let i=this.formData.linkedChildrenIds.indexOf(t);i>=0?this.formData.linkedChildrenIds.splice(i,1):this.formData.linkedChildrenIds.push(t)}submit(){return O(this,null,function*(){if(!this.isSubmitting){this.isSubmitting=!0;try{let t={title:this.formData.title.trim(),description:this.formData.description.trim(),category:this.formData.category,priority:this.formData.priority,targetDate:this.formData.targetDate||void 0,deadline:this.formData.deadline||void 0,linkedChildrenIds:this.formData.linkedChildrenIds};this.isEdit&&this.data?.topic?yield this.topicsService.updateTopic(this.data.topic.id,t):yield this.topicsService.createTopic(t),this.dialogRef.close(!0)}catch(t){console.error("Error saving topic:",t)}finally{this.isSubmitting=!1}}})}close(){this.dialogRef.close()}static \u0275fac=function(i){return new(i||m)(V(de,8))};static \u0275cmp=E({type:m,selectors:[["app-topic-form"]],decls:52,vars:14,consts:[["topicForm","ngForm"],["targetPicker",""],["deadlinePicker",""],[1,"topic-form"],[1,"form-header"],["mat-icon-button","",3,"click"],[3,"ngSubmit"],[1,"form-content"],["appearance","outline",1,"full-width"],["matInput","","name","title","required","","placeholder","\u05DC\u05D3\u05D5\u05D2\u05DE\u05D4: \u05D7\u05D5\u05E4\u05E9\u05D4 \u05DC\u05D0\u05D9\u05DC\u05EA",3,"ngModelChange","ngModel"],[1,"form-row"],["appearance","outline",1,"half-width"],["name","category","required","",3,"ngModelChange","ngModel"],[3,"value"],["name","priority",3,"ngModelChange","ngModel"],["matInput","","name","description","rows","3","placeholder","\u05D1\u05DE\u05D4 \u05DE\u05D3\u05D5\u05D1\u05E8? \u05DE\u05D4 \u05D4\u05DE\u05D8\u05E8\u05D5\u05EA?",3,"ngModelChange","ngModel"],["matInput","","name","targetDate",3,"ngModelChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],["matInput","","name","deadline",3,"ngModelChange","matDatepicker","ngModel"],[1,"children-section"],[1,"form-footer"],["mat-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"section-label"],[1,"children-chips"],[1,"child-chip",3,"selected"],[1,"child-chip"],["type","checkbox",3,"change","checked"],[1,"chip-dot"]],template:function(i,e){if(i&1){let d=k();r(0,"div",3)(1,"header",4)(2,"h2"),l(3),o(),r(4,"button",5),_("click",function(){return p(d),s(e.close())}),r(5,"mat-icon"),l(6,"close"),o()()(),r(7,"form",6,0),_("ngSubmit",function(){return p(d),s(e.submit())}),r(9,"div",7)(10,"mat-form-field",8)(11,"mat-label"),l(12,"\u05DB\u05D5\u05EA\u05E8\u05EA"),o(),r(13,"input",9),h("ngModelChange",function(a){return p(d),D(e.formData.title,a)||(e.formData.title=a),s(a)}),o()(),r(14,"div",10)(15,"mat-form-field",11)(16,"mat-label"),l(17,"\u05E7\u05D8\u05D2\u05D5\u05E8\u05D9\u05D4"),o(),r(18,"mat-select",12),h("ngModelChange",function(a){return p(d),D(e.formData.category,a)||(e.formData.category=a),s(a)}),b(19,be,4,5,"mat-option",13,F),o()(),r(21,"mat-form-field",11)(22,"mat-label"),l(23,"\u05E2\u05D3\u05D9\u05E4\u05D5\u05EA"),o(),r(24,"mat-select",14),h("ngModelChange",function(a){return p(d),D(e.formData.priority,a)||(e.formData.priority=a),s(a)}),b(25,Se,4,5,"mat-option",13,F),o()()(),r(27,"mat-form-field",8)(28,"mat-label"),l(29,"\u05EA\u05D9\u05D0\u05D5\u05E8"),o(),r(30,"textarea",15),h("ngModelChange",function(a){return p(d),D(e.formData.description,a)||(e.formData.description=a),s(a)}),o()(),r(31,"div",10)(32,"mat-form-field",11)(33,"mat-label"),l(34,"\u05EA\u05D0\u05E8\u05D9\u05DA \u05D9\u05E2\u05D3"),o(),r(35,"input",16),h("ngModelChange",function(a){return p(d),D(e.formData.targetDate,a)||(e.formData.targetDate=a),s(a)}),o(),w(36,"mat-datepicker-toggle",17)(37,"mat-datepicker",null,1),o(),r(39,"mat-form-field",11)(40,"mat-label"),l(41,"\u05D3\u05D3\u05DC\u05D9\u05D9\u05DF"),o(),r(42,"input",18),h("ngModelChange",function(a){return p(d),D(e.formData.deadline,a)||(e.formData.deadline=a),s(a)}),o(),w(43,"mat-datepicker-toggle",17)(44,"mat-datepicker",null,2),o()(),W(46,ve,6,0,"div",19),o(),r(47,"footer",20)(48,"button",21),_("click",function(){return p(d),s(e.close())}),l(49,"\u05D1\u05D9\u05D8\u05D5\u05DC"),o(),r(50,"button",22),l(51),o()()()()}if(i&2){let d=T(8),c=T(38),a=T(45);n(3),g(e.isEdit?"\u05E2\u05E8\u05D9\u05DB\u05EA \u05E0\u05D5\u05E9\u05D0":"\u05E0\u05D5\u05E9\u05D0 \u05D7\u05D3\u05E9"),n(10),f("ngModel",e.formData.title),n(5),f("ngModel",e.formData.category),n(),S(e.categories),n(5),f("ngModel",e.formData.priority),n(),S(e.priorities),n(5),f("ngModel",e.formData.description),n(5),u("matDatepicker",c),f("ngModel",e.formData.targetDate),n(),u("for",c),n(6),u("matDatepicker",a),f("ngModel",e.formData.deadline),n(),u("for",a),n(3),A(e.familyService.children().length>0?46:-1),n(4),u("disabled",!d.valid||e.isSubmitting),n(),M(" ",e.isEdit?"\u05E9\u05DE\u05D5\u05E8":"\u05E6\u05D5\u05E8 \u05E0\u05D5\u05E9\u05D0"," ")}},dependencies:[x,Y,U,G,H,J,X,Q,K,q,z,j,I,P,oe,ie,ee,Z,$,te,se,pe,N,De,ue,ge,fe,L,he,ce],styles:[".topic-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:90vh}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;border-bottom:1px solid var(--border-subtle)}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600}.form-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}@media(max-width:480px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.half-width[_ngcontent-%COMP%]{flex:1}.section-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:.5rem}.children-section[_ngcontent-%COMP%]{margin-top:.5rem}.children-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.child-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--surface-secondary);border:1px solid var(--border-subtle);border-radius:9999px;cursor:pointer;transition:all .15s ease}.child-chip[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.child-chip[_ngcontent-%COMP%]   .chip-dot[_ngcontent-%COMP%]{width:12px;height:12px;border-radius:50%}.child-chip[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.child-chip.selected[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff;border-color:var(--color-primary)}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.5rem;border-top:1px solid var(--border-subtle)}"]})};export{Ce as a,_e as b};
