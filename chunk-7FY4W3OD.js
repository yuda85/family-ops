import{a as Ce}from"./chunk-WWGZZJCE.js";import{a as ge,b as fe}from"./chunk-W75OOGN4.js";import{a as pt,b as ut}from"./chunk-RDNZAE64.js";import{a as re,c as It,d as Vt,f as ae,g as se}from"./chunk-KKYRDIC6.js";import{a as At,b as dt}from"./chunk-R7YJ63L2.js";import{a as de,b as pe,c as ue,d as _e}from"./chunk-DBA5HZUL.js";import{a as me,c as Lt}from"./chunk-T3S3PSFS.js";import{a as ce,b as le,c as Ft,g as mt}from"./chunk-PKSSNXGP.js";import"./chunk-ES7NJO36.js";import{a as Q,c as oe,d as X}from"./chunk-BFWFC2UO.js";import{c as Ot}from"./chunk-EI4X5JRH.js";import{a as ee,e as ne,h as ie}from"./chunk-DNCMLEWE.js";import{a as St,b as Pt}from"./chunk-BCPCSMU2.js";import{a as lt}from"./chunk-OHB7MTR6.js";import{a as et,b as nt,c as it,d as ot}from"./chunk-PHBB3HXL.js";import{b as ct}from"./chunk-BUPX7NXY.js";import"./chunk-JCYEYCY7.js";import{a as Yt}from"./chunk-O6HJ35IU.js";import"./chunk-KMKHW2SX.js";import"./chunk-RJL43Y7W.js";import{f as Kt}from"./chunk-HS2XTPUM.js";import{b as j,f as U,g as Qt,h as Xt,i as q,j as Zt,o as te,q as H}from"./chunk-FSRTV3VH.js";import"./chunk-QJJTVXVB.js";import{d as N}from"./chunk-X4QG5DAP.js";import{a as Y,b as tt,d as R,e as z,f as W}from"./chunk-SXGBHULN.js";import"./chunk-EB5YHKWW.js";import{a as bt,e as Et,i as wt,j as st}from"./chunk-JFU3JZIN.js";import{a as qt,c as Ht,d as Gt,i as Jt}from"./chunk-TWWUOU6R.js";import{j as Dt,k as $}from"./chunk-OJNKK6II.js";import{$a as Ut,$b as O,Ab as M,Bb as h,Cb as r,Db as a,Eb as S,Lb as f,Pb as _,Qa as K,Rb as c,Sa as l,T as vt,Y as v,ac as B,ba as p,bc as I,ca as u,dc as m,ec as y,fb as A,fc as k,gc as J,ic as D,ja as G,jc as b,kc as E,oa as w,pc as Tt,qc as Mt,uc as F,vb as C,wb as g,yb as yt,zb as T}from"./chunk-QZLPLYI5.js";import{a as V,b as Ct,f as x}from"./chunk-ATWMZ64T.js";var rt=class o{firestoreService=v(wt);authService=v(st);familyService=v(N);tasksSubscription;_tasks=w([]);_currentTopicId=w(null);_isLoading=w(!1);_error=w(null);tasks=this._tasks.asReadonly();isLoading=this._isLoading.asReadonly();error=this._error.asReadonly();totalCount=F(()=>this._tasks().length);completedCount=F(()=>this._tasks().filter(e=>e.status==="completed").length);pendingCount=F(()=>this._tasks().filter(e=>e.status==="pending").length);inProgressCount=F(()=>this._tasks().filter(e=>e.status==="in_progress").length);progress=F(()=>{let e=this.totalCount();return e===0?0:this.completedCount()/e*100});groupedTasks=F(()=>{let e=this._tasks(),t=e.filter(s=>s.status==="pending").sort((s,d)=>s.order-d.order),n=e.filter(s=>s.status==="in_progress").sort((s,d)=>s.order-d.order),i=e.filter(s=>s.status==="completed").sort((s,d)=>(d.completedAt?.toMillis()||0)-(s.completedAt?.toMillis()||0));return{pending:t,inProgress:n,completed:i}});myTasks=F(()=>{let e=this.authService.userId();return e?this._tasks().filter(t=>t.assignedTo.includes(e)):[]});overdueTasks=F(()=>{let e=new Date;return this._tasks().filter(t=>t.dueDate&&t.dueDate.toDate()<e&&t.status!=="completed")});upcomingTasks=F(()=>{let e=new Date,t=new Date(e.getTime()+10080*60*1e3);return this._tasks().filter(n=>n.dueDate&&n.dueDate.toDate()>=e&&n.dueDate.toDate()<=t&&n.status!=="completed").sort((n,i)=>n.dueDate.toMillis()-i.dueDate.toMillis())});ngOnDestroy(){this.unsubscribe()}subscribeToTasks(e){let t=this.familyService.familyId();if(!t){this._tasks.set([]);return}this._currentTopicId.set(e),this._isLoading.set(!0),this._error.set(null),this.tasksSubscription?.unsubscribe(),this.tasksSubscription=this.firestoreService.getCollection$(`families/${t}/topics/${e}/tasks`,Et("order","asc")).subscribe({next:n=>{this._tasks.set(n),this._isLoading.set(!1)},error:n=>{console.error("Error subscribing to tasks:",n),this._error.set("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D8\u05E2\u05D9\u05E0\u05EA \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA"),this._isLoading.set(!1)}})}createTask(e,t){return x(this,null,function*(){let n=this.familyService.familyId(),i=this.authService.userId();if(!n||!i)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");if(!this.familyService.canEdit())throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05D9\u05E6\u05D5\u05E8 \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA");let s=this._tasks().reduce((L,Z)=>Math.max(L,Z.order),-1),d={topicId:e,title:t.title,description:t.description||"",assignedTo:t.assignedTo||[],dueDate:t.dueDate?bt.fromDate(t.dueDate):void 0,status:"pending",priority:t.priority||"medium",subtasks:[],order:s+1,createdBy:i},P=yield this.firestoreService.createDocument(`families/${n}/topics/${e}/tasks`,d);return yield this.updateTopicTaskCount(e,1,0),P})}updateTask(e,t,n){return x(this,null,function*(){let i=this.familyService.familyId(),s=this.authService.userId();if(!i||!s)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");if(!this.familyService.canEdit())throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05E2\u05D3\u05DB\u05DF \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA");let d={};if(n.title!==void 0&&(d.title=n.title),n.description!==void 0&&(d.description=n.description),n.assignedTo!==void 0&&(d.assignedTo=n.assignedTo),n.priority!==void 0&&(d.priority=n.priority),n.subtasks!==void 0&&(d.subtasks=n.subtasks),n.order!==void 0&&(d.order=n.order),n.dueDate!==void 0&&(d.dueDate=n.dueDate?bt.fromDate(n.dueDate):null),n.status!==void 0){let L=this._tasks().find(Me=>Me.id===t)?.status==="completed",Z=n.status==="completed";d.status=n.status,Z&&!L?(d.completedAt=this.firestoreService.getServerTimestamp(),d.completedBy=s,yield this.updateTopicTaskCount(e,0,1)):!Z&&L&&(d.completedAt=null,d.completedBy=null,yield this.updateTopicTaskCount(e,0,-1))}yield this.firestoreService.updateDocument(`families/${i}/topics/${e}/tasks/${t}`,d)})}toggleTaskStatus(e,t){return x(this,null,function*(){let n=this._tasks().find(s=>s.id===t);if(!n)return;let i=n.status==="completed"?"pending":"completed";yield this.updateTask(e,t,{status:i})})}startTask(e,t){return x(this,null,function*(){yield this.updateTask(e,t,{status:"in_progress"})})}deleteTask(e,t){return x(this,null,function*(){let n=this.familyService.familyId();if(!n)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");if(!this.familyService.canEdit())throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05DE\u05D7\u05D5\u05E7 \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA");let s=this._tasks().find(d=>d.id===t)?.status==="completed";yield this.firestoreService.deleteDocument(`families/${n}/topics/${e}/tasks/${t}`),yield this.updateTopicTaskCount(e,-1,s?-1:0)})}addSubtask(e,t,n){return x(this,null,function*(){let i=this._tasks().find(P=>P.id===t);if(!i)return;let s={id:crypto.randomUUID(),text:n,isCompleted:!1,order:i.subtasks.length},d=[...i.subtasks,s];yield this.updateTask(e,t,{subtasks:d})})}toggleSubtask(e,t,n){return x(this,null,function*(){let i=this._tasks().find(d=>d.id===t);if(!i)return;let s=i.subtasks.map(d=>d.id===n?Ct(V({},d),{isCompleted:!d.isCompleted,completedAt:d.isCompleted?void 0:bt.now()}):d);yield this.updateTask(e,t,{subtasks:s})})}deleteSubtask(e,t,n){return x(this,null,function*(){let i=this._tasks().find(d=>d.id===t);if(!i)return;let s=i.subtasks.filter(d=>d.id!==n);yield this.updateTask(e,t,{subtasks:s})})}assignTask(e,t,n){return x(this,null,function*(){yield this.updateTask(e,t,{assignedTo:n})})}reorderTasks(e,t){return x(this,null,function*(){let n=this.familyService.familyId();if(!n)return;let i=t.map((s,d)=>({type:"update",path:`families/${n}/topics/${e}/tasks/${s}`,data:{order:d}}));yield this.firestoreService.batchWrite(i)})}clearTasks(){this._tasks.set([]),this._currentTopicId.set(null),this.tasksSubscription?.unsubscribe()}clearError(){this._error.set(null)}unsubscribe(){this.tasksSubscription?.unsubscribe()}updateTopicTaskCount(e,t,n){return x(this,null,function*(){let i=this.familyService.familyId();if(i)try{let s=yield this.firestoreService.getDocument(`families/${i}/topics/${e}`);s&&(yield this.firestoreService.updateDocument(`families/${i}/topics/${e}`,{taskCount:Math.max(0,(s.taskCount||0)+t),completedTaskCount:Math.max(0,(s.completedTaskCount||0)+n)}))}catch(s){console.error("Error updating topic task count:",s)}})}static \u0275fac=function(t){return new(t||o)};static \u0275prov=vt({token:o,factory:o.\u0275fac,providedIn:"root"})};var _t=class o{firestoreService=v(wt);authService=v(st);familyService=v(N);commentsSubscription;_comments=w([]);_currentTopicId=w(null);_isLoading=w(!1);_error=w(null);comments=this._comments.asReadonly();isLoading=this._isLoading.asReadonly();error=this._error.asReadonly();totalCount=F(()=>this._comments().length);topLevelComments=F(()=>this._comments().filter(e=>!e.parentCommentId).sort((e,t)=>(t.createdAt?.toMillis()??0)-(e.createdAt?.toMillis()??0)));getReplies(e){return this._comments().filter(t=>t.parentCommentId===e).sort((t,n)=>(t.createdAt?.toMillis()??0)-(n.createdAt?.toMillis()??0))}ngOnDestroy(){this.unsubscribe()}subscribeToComments(e){let t=this.familyService.familyId();if(!t){this._comments.set([]);return}this._currentTopicId.set(e),this._isLoading.set(!0),this._error.set(null),this.commentsSubscription?.unsubscribe(),this.commentsSubscription=this.firestoreService.getCollection$(`families/${t}/topics/${e}/comments`,Et("createdAt","desc")).subscribe({next:n=>{this._comments.set(n),this._isLoading.set(!1)},error:n=>{console.error("Error subscribing to comments:",n),this._error.set("\u05E9\u05D2\u05D9\u05D0\u05D4 \u05D1\u05D8\u05E2\u05D9\u05E0\u05EA \u05EA\u05D2\u05D5\u05D1\u05D5\u05EA"),this._isLoading.set(!1)}})}createComment(e,t){return x(this,null,function*(){let n=this.familyService.familyId(),i=this.authService.userId();if(!n||!i)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");if(!this.familyService.canEdit())throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05D4\u05D2\u05D9\u05D1");let s=V({topicId:e,content:t.content.trim(),replyCount:0,reactions:{},mentionedUserIds:t.mentionedUserIds||[],isEdited:!1,createdBy:i},t.parentCommentId&&{parentCommentId:t.parentCommentId}),d=yield this.firestoreService.createDocument(`families/${n}/topics/${e}/comments`,s);return t.parentCommentId&&(yield this.incrementReplyCount(e,t.parentCommentId)),yield this.updateTopicCommentCount(e,1),d})}updateComment(e,t,n){return x(this,null,function*(){let i=this.familyService.familyId(),s=this.authService.userId();if(!i||!s)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");let d=this._comments().find(P=>P.id===t);if(!d||d.createdBy!==s)throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05E2\u05E8\u05D5\u05DA \u05EA\u05D2\u05D5\u05D1\u05D4 \u05D6\u05D5");yield this.firestoreService.updateDocument(`families/${i}/topics/${e}/comments/${t}`,{content:n.trim(),isEdited:!0,editedAt:this.firestoreService.getServerTimestamp()})})}deleteComment(e,t){return x(this,null,function*(){let n=this.familyService.familyId(),i=this.authService.userId();if(!n||!i)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");let s=this._comments().find(L=>L.id===t);if(!s)return;if(s.createdBy!==i&&!this.familyService.isAdmin())throw new Error("\u05D0\u05D9\u05DF \u05DC\u05DA \u05D4\u05E8\u05E9\u05D0\u05D4 \u05DC\u05DE\u05D7\u05D5\u05E7 \u05EA\u05D2\u05D5\u05D1\u05D4 \u05D6\u05D5");yield this.firestoreService.deleteDocument(`families/${n}/topics/${e}/comments/${t}`),s.parentCommentId&&(yield this.incrementReplyCount(e,s.parentCommentId,-1));let d=1+s.replyCount;yield this.updateTopicCommentCount(e,-d);let P=this.getReplies(t);for(let L of P)yield this.firestoreService.deleteDocument(`families/${n}/topics/${e}/comments/${L.id}`)})}toggleReaction(e,t,n){return x(this,null,function*(){let i=this.familyService.familyId(),s=this.authService.userId();if(!i||!s)throw new Error("\u05D0\u05D9\u05DF \u05DE\u05E9\u05E4\u05D7\u05D4 \u05E4\u05E2\u05D9\u05DC\u05D4");let d=this._comments().find(Z=>Z.id===t);if(!d)return;let P=V({},d.reactions),L=P[n]||[];L.includes(s)?(P[n]=L.filter(Z=>Z!==s),P[n].length===0&&delete P[n]):P[n]=[...L,s],yield this.firestoreService.updateDocument(`families/${i}/topics/${e}/comments/${t}`,{reactions:P})})}clearComments(){this._comments.set([]),this._currentTopicId.set(null),this.commentsSubscription?.unsubscribe()}clearError(){this._error.set(null)}unsubscribe(){this.commentsSubscription?.unsubscribe()}incrementReplyCount(e,t,n=1){return x(this,null,function*(){let i=this.familyService.familyId();if(!i)return;let s=this._comments().find(d=>d.id===t);s&&(yield this.firestoreService.updateDocument(`families/${i}/topics/${e}/comments/${t}`,{replyCount:Math.max(0,s.replyCount+n)}))})}updateTopicCommentCount(e,t){return x(this,null,function*(){let n=this.familyService.familyId();if(n)try{let i=yield this.firestoreService.getDocument(`families/${n}/topics/${e}`);i&&(yield this.firestoreService.updateDocument(`families/${n}/topics/${e}`,{commentCount:Math.max(0,(i.commentCount||0)+t)}))}catch(i){console.error("Error updating topic comment count:",i)}})}static \u0275fac=function(t){return new(t||o)};static \u0275prov=vt({token:o,factory:o.\u0275fac,providedIn:"root"})};var xe=(o,e)=>e.id;function be(o,e){if(o&1){let t=f();r(0,"input",12,1),E("ngModelChange",function(i){p(t);let s=c();return b(s.editingTitle,i)||(s.editingTitle=i),u(i)}),_("blur",function(){p(t);let i=c();return u(i.saveTitle())})("keydown.enter",function(){p(t);let i=c();return u(i.saveTitle())})("keydown.escape",function(){p(t);let i=c();return u(i.cancelTitleEdit())}),a()}if(o&2){let t=c();D("ngModel",t.editingTitle)}}function Ee(o,e){if(o&1&&(r(0,"span",14),m(1),a()),o&2){let t=c(2);l(),J("",t.completedItemsCount,"/",t.section.items.length)}}function we(o,e){if(o&1){let t=f();r(0,"h3",13),_("click",function(){p(t);let i=c();return u(i.toggleCollapse())}),m(1),C(2,Ee,2,2,"span",14),a()}if(o&2){let t=c();l(),k(" ",t.section.title||t.getSectionTypeLabel()," "),l(),g(t.section.type==="checklist"&&t.section.items&&t.section.items.length>0?2:-1)}}function Se(o,e){if(o&1){let t=f();r(0,"textarea",20),E("ngModelChange",function(i){p(t);let s=c(3);return b(s.editingContent,i)||(s.editingContent=i),u(i)}),_("blur",function(){p(t);let i=c(3);return u(i.saveContent())}),a()}if(o&2){let t=c(3);D("ngModel",t.editingContent)}}function Pe(o,e){if(o&1){let t=f();r(0,"div",21),_("click",function(){p(t);let i=c(3);return u(i.startContentEdit())}),m(1),a()}if(o&2){let t=c(3);I("empty",!t.section.content),l(),k(" ",t.section.content||"\u05DC\u05D7\u05E5 \u05DC\u05D4\u05D5\u05E1\u05E4\u05EA \u05EA\u05D5\u05DB\u05DF..."," ")}}function Oe(o,e){if(o&1&&(r(0,"div",15),C(1,Se,1,1,"textarea",18)(2,Pe,2,3,"div",19),a()),o&2){let t=c(2);l(),g(t.isEditingContent?1:2)}}function Ie(o,e){if(o&1){let t=f();r(0,"input",29),E("ngModelChange",function(i){p(t);let s=c(4);return b(s.editingItemText,i)||(s.editingItemText=i),u(i)}),_("blur",function(){p(t);let i=c().$implicit,s=c(3);return u(s.saveChecklistItem(i))})("keydown.enter",function(){p(t);let i=c().$implicit,s=c(3);return u(s.saveChecklistItem(i))})("keydown.escape",function(){p(t);let i=c(4);return u(i.cancelItemEdit())}),a()}if(o&2){let t=c(4);D("ngModel",t.editingItemText)}}function Ve(o,e){if(o&1){let t=f();r(0,"span",30),_("click",function(){p(t);let i=c().$implicit,s=c(3);return u(s.startItemEdit(i))}),m(1),a()}if(o&2){let t=c().$implicit;I("completed",t.isCompleted),l(),k(" ",t.text," ")}}function Fe(o,e){if(o&1){let t=f();r(0,"div",22)(1,"mat-checkbox",25),_("change",function(){let i=p(t).$implicit,s=c(3);return u(s.toggleChecklistItem(i))}),a(),C(2,Ie,1,1,"input",26)(3,Ve,2,3,"span",27),r(4,"button",28),_("click",function(){let i=p(t).$implicit,s=c(3);return u(s.removeChecklistItem(i))}),r(5,"mat-icon"),m(6,"close"),a()()()}if(o&2){let t=e.$implicit,n=c(3);l(),h("checked",t.isCompleted),l(),g(n.editingItemId===t.id?2:3)}}function Le(o,e){if(o&1){let t=f();r(0,"div",16),T(1,Fe,7,2,"div",22,xe),r(3,"div",23)(4,"mat-icon"),m(5,"add"),a(),r(6,"input",24),E("ngModelChange",function(i){p(t);let s=c(2);return b(s.newItemText,i)||(s.newItemText=i),u(i)}),_("keydown.enter",function(){p(t);let i=c(2);return u(i.addChecklistItem())}),a()()()}if(o&2){let t=c(2);l(),M(t.section.items),l(5),D("ngModel",t.newItemText)}}function Ae(o,e){if(o&1&&(r(0,"span",36),m(1),a()),o&2){let t=c().$implicit;l(),y(t.description)}}function Be(o,e){if(o&1){let t=f();r(0,"a",31)(1,"mat-icon"),m(2,"link"),a(),r(3,"div",34)(4,"span",35),m(5),a(),C(6,Ae,2,1,"span",36),a(),r(7,"button",28),_("click",function(i){let s=p(t).$implicit,d=c(3);return u(d.removeLink(s,i))}),r(8,"mat-icon"),m(9,"close"),a()()()}if(o&2){let t=e.$implicit;h("href",t.url,K),l(5),y(t.title),l(),g(t.description?6:-1)}}function $e(o,e){if(o&1){let t=f();r(0,"div",17),T(1,Be,10,3,"a",31,xe),r(3,"div",32)(4,"mat-icon"),m(5,"add_link"),a(),r(6,"input",33),E("ngModelChange",function(i){p(t);let s=c(2);return b(s.newLinkUrl,i)||(s.newLinkUrl=i),u(i)}),_("keydown.enter",function(){p(t);let i=c(2);return u(i.addLink())}),a()()()}if(o&2){let t=c(2);l(),M(t.section.links),l(5),D("ngModel",t.newLinkUrl)}}function Ne(o,e){if(o&1&&(r(0,"div",11),C(1,Oe,3,1,"div",15)(2,Le,7,1,"div",16)(3,$e,7,1,"div",17),a()),o&2){let t,n=c();l(),g((t=n.section.type)==="text"?1:t==="checklist"?2:t==="links"?3:-1)}}var Bt=class o{section;sectionChange=new G;delete=new G;isEditingTitle=!1;isEditingContent=!1;editingTitle="";editingContent="";editingItemId=null;editingItemText="";newItemText="";newLinkUrl="";get completedItemsCount(){return this.section.items?.filter(e=>e.isCompleted).length||0}getSectionTypeLabel(){switch(this.section.type){case"text":return"\u05D8\u05E7\u05E1\u05D8";case"checklist":return"\u05E8\u05E9\u05D9\u05DE\u05EA \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA";case"links":return"\u05E7\u05D9\u05E9\u05D5\u05E8\u05D9\u05DD";default:return"\u05E7\u05D8\u05E2"}}toggleCollapse(){this.emitChange({isCollapsed:!this.section.isCollapsed})}startTitleEdit(){this.editingTitle=this.section.title,this.isEditingTitle=!0}saveTitle(){this.editingTitle.trim()!==this.section.title&&this.emitChange({title:this.editingTitle.trim()}),this.isEditingTitle=!1}cancelTitleEdit(){this.isEditingTitle=!1}startContentEdit(){this.editingContent=this.section.content||"",this.isEditingContent=!0}saveContent(){this.editingContent!==this.section.content&&this.emitChange({content:this.editingContent}),this.isEditingContent=!1}toggleChecklistItem(e){let t=this.section.items?.map(n=>n.id===e.id?Ct(V({},n),{isCompleted:!n.isCompleted}):n);this.emitChange({items:t})}startItemEdit(e){this.editingItemId=e.id,this.editingItemText=e.text}saveChecklistItem(e){if(this.editingItemText.trim()!==e.text){let t=this.section.items?.map(n=>n.id===e.id?Ct(V({},n),{text:this.editingItemText.trim()}):n);this.emitChange({items:t})}this.editingItemId=null,this.editingItemText=""}cancelItemEdit(){this.editingItemId=null,this.editingItemText=""}addChecklistItem(){if(!this.newItemText.trim())return;let e={id:crypto.randomUUID(),text:this.newItemText.trim(),isCompleted:!1,order:this.section.items?.length||0},t=[...this.section.items||[],e];this.emitChange({items:t}),this.newItemText=""}removeChecklistItem(e){let t=this.section.items?.filter(n=>n.id!==e.id);this.emitChange({items:t})}addLink(){if(!this.newLinkUrl.trim())return;let e=this.newLinkUrl.trim(),t={id:crypto.randomUUID(),url:e.startsWith("http")?e:`https://${e}`,title:this.extractDomain(e),order:this.section.links?.length||0},n=[...this.section.links||[],t];this.emitChange({links:n}),this.newLinkUrl=""}removeLink(e,t){t.preventDefault(),t.stopPropagation();let n=this.section.links?.filter(i=>i.id!==e.id);this.emitChange({links:n})}onDelete(){this.delete.emit()}emitChange(e){this.sectionChange.emit(V(V({},this.section),e))}extractDomain(e){try{return new URL(e.startsWith("http")?e:`https://${e}`).hostname.replace("www.","")}catch{return e}}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=A({type:o,selectors:[["app-content-section"]],inputs:{section:"section"},outputs:{sectionChange:"sectionChange",delete:"delete"},decls:24,vars:6,consts:[["sectionMenu","matMenu"],["titleInput",""],[1,"content-section"],[1,"section-header"],[1,"collapse-btn",3,"click"],[1,"title-input",3,"ngModel"],[1,"section-title"],[1,"section-actions"],["mat-icon-button","",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-item",3,"click"],[1,"section-content"],[1,"title-input",3,"ngModelChange","blur","keydown.enter","keydown.escape","ngModel"],[1,"section-title",3,"click"],[1,"checklist-count"],[1,"text-section"],[1,"checklist-section"],[1,"links-section"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05EA\u05D5\u05DB\u05DF...","rows","4",1,"content-textarea",3,"ngModel"],[1,"content-display",3,"empty"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05EA\u05D5\u05DB\u05DF...","rows","4",1,"content-textarea",3,"ngModelChange","blur","ngModel"],[1,"content-display",3,"click"],[1,"checklist-item"],[1,"add-item"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05E4\u05E8\u05D9\u05D8...",1,"add-input",3,"ngModelChange","keydown.enter","ngModel"],[3,"change","checked"],[1,"item-input",3,"ngModel"],[1,"item-text",3,"completed"],["mat-icon-button","",1,"delete-btn",3,"click"],[1,"item-input",3,"ngModelChange","blur","keydown.enter","keydown.escape","ngModel"],[1,"item-text",3,"click"],["target","_blank","rel","noopener noreferrer",1,"link-item",3,"href"],[1,"add-link"],["placeholder","\u05D4\u05D3\u05D1\u05E7 \u05E7\u05D9\u05E9\u05D5\u05E8...",1,"add-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"link-info"],[1,"link-title"],[1,"link-description"]],template:function(t,n){if(t&1){let i=f();r(0,"div",2)(1,"div",3)(2,"button",4),_("click",function(){return p(i),u(n.toggleCollapse())}),r(3,"mat-icon"),m(4),a()(),C(5,be,2,1,"input",5)(6,we,3,2,"h3",6),r(7,"div",7)(8,"button",8)(9,"mat-icon"),m(10,"more_vert"),a()(),r(11,"mat-menu",null,0)(13,"button",9),_("click",function(){return p(i),u(n.startTitleEdit())}),r(14,"mat-icon"),m(15,"edit"),a(),r(16,"span"),m(17,"\u05E2\u05E8\u05D5\u05DA \u05DB\u05D5\u05EA\u05E8\u05EA"),a()(),r(18,"button",10),_("click",function(){return p(i),u(n.onDelete())}),r(19,"mat-icon"),m(20,"delete"),a(),r(21,"span"),m(22,"\u05DE\u05D7\u05E7"),a()()()()(),C(23,Ne,4,1,"div",11),a()}if(t&2){let i=O(12);I("collapsed",n.section.isCollapsed),l(4),y(n.section.isCollapsed?"expand_more":"expand_less"),l(),g(n.isEditingTitle?5:6),l(3),h("matMenuTriggerFor",i),l(15),g(n.section.isCollapsed?-1:23)}},dependencies:[$,H,j,U,q,W,z,R,Y,X,Q,dt,At,ot,nt,et,it],styles:[".content-section[_ngcontent-%COMP%]{background:var(--surface-primary);border:1px solid var(--border-subtle);border-radius:.75rem;overflow:hidden}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.75rem 1rem;background:var(--surface-secondary)}.collapse-btn[_ngcontent-%COMP%]{background:none;border:none;cursor:pointer;padding:0;color:var(--text-tertiary);display:flex;align-items:center}.section-title[_ngcontent-%COMP%]{flex:1;margin:0;font-size:.9375rem;font-weight:600;color:var(--text-primary);cursor:pointer;display:flex;align-items:center;gap:.5rem}.section-title[_ngcontent-%COMP%]   .checklist-count[_ngcontent-%COMP%]{font-size:.75rem;font-weight:500;color:var(--text-secondary);background:var(--surface-tertiary);padding:.125rem .5rem;border-radius:9999px}.title-input[_ngcontent-%COMP%]{flex:1;font-size:.9375rem;font-weight:600;padding:.25rem .5rem;border:1px solid var(--color-primary);border-radius:.25rem;outline:none;background:var(--surface-primary);color:var(--text-primary)}.section-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem}.section-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:var(--text-tertiary)}.section-content[_ngcontent-%COMP%]{padding:1rem}.text-section[_ngcontent-%COMP%]   .content-textarea[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--border-subtle);border-radius:.5rem;font-family:inherit;font-size:.9375rem;line-height:1.5;resize:vertical;background:var(--surface-primary);color:var(--text-primary)}.text-section[_ngcontent-%COMP%]   .content-textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary)}.text-section[_ngcontent-%COMP%]   .content-display[_ngcontent-%COMP%]{padding:.75rem;border:1px dashed var(--border-subtle);border-radius:.5rem;cursor:pointer;white-space:pre-wrap;line-height:1.5;color:var(--text-primary)}.text-section[_ngcontent-%COMP%]   .content-display[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.text-section[_ngcontent-%COMP%]   .content-display.empty[_ngcontent-%COMP%]{color:var(--text-tertiary)}.checklist-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.checklist-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.25rem 0}.checklist-item[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%]{flex:1;cursor:pointer;padding:.25rem;color:var(--text-primary)}.checklist-item[_ngcontent-%COMP%]   .item-text.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--text-tertiary)}.checklist-item[_ngcontent-%COMP%]   .item-text[_ngcontent-%COMP%]:hover{background:var(--surface-hover);border-radius:.25rem}.checklist-item[_ngcontent-%COMP%]   .item-input[_ngcontent-%COMP%]{flex:1;padding:.25rem .5rem;border:1px solid var(--color-primary);border-radius:.25rem;outline:none;background:var(--surface-primary);color:var(--text-primary)}.checklist-item[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{opacity:0;transition:opacity .15s ease;color:var(--text-tertiary)}.checklist-item[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover{color:var(--color-error)}.checklist-item[_ngcontent-%COMP%]:hover   .delete-btn[_ngcontent-%COMP%]{opacity:1}.add-item[_ngcontent-%COMP%], .add-link[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.5rem;color:var(--text-tertiary)}.add-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .add-link[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px}.add-item[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%], .add-link[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;font-size:.875rem;outline:none;color:var(--text-primary)}.add-item[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%]::placeholder, .add-link[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.links-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.link-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem;background:var(--surface-secondary);border-radius:.5rem;text-decoration:none;transition:background .15s ease}.link-item[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.link-item[_ngcontent-%COMP%]:hover   .delete-btn[_ngcontent-%COMP%]{opacity:1}.link-item[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--color-primary)}.link-item[_ngcontent-%COMP%]   .link-info[_ngcontent-%COMP%]{flex:1;min-width:0}.link-item[_ngcontent-%COMP%]   .link-title[_ngcontent-%COMP%]{display:block;color:var(--text-primary);font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.link-item[_ngcontent-%COMP%]   .link-description[_ngcontent-%COMP%]{display:block;color:var(--text-secondary);font-size:.75rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.link-item[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]{opacity:0;color:var(--text-tertiary)}.link-item[_ngcontent-%COMP%]   .delete-btn[_ngcontent-%COMP%]:hover, .delete-item[_ngcontent-%COMP%]{color:var(--color-error)}"]})};var ke=(o,e)=>e.id;function Re(o,e){if(o&1&&(r(0,"span",16)(1,"mat-icon"),m(2),a()()),o&2){let t=c();B("color",t.getPriorityMeta(t.task.priority).color),l(2),y(t.getPriorityMeta(t.task.priority).icon)}}function ze(o,e){if(o&1&&(r(0,"span",17)(1,"mat-icon"),m(2,"schedule"),a(),m(3),a()),o&2){let t=c();I("overdue",t.isOverdue),l(3),k(" ",t.formatDueDate(t.task.dueDate.toDate())," ")}}function We(o,e){if(o&1&&(r(0,"span",9)(1,"mat-icon"),m(2,"checklist"),a(),m(3),a()),o&2){let t=c();l(3),J(" ",t.completedSubtasks,"/",t.task.subtasks.length," ")}}function je(o,e){if(o&1&&S(0,"img",20),o&2){let t=c().$implicit;h("src",t.photoURL,K)("alt",t.displayName)}}function Ue(o,e){if(o&1&&m(0),o&2){let t=c().$implicit;k(" ",t.displayName.charAt(0)," ")}}function qe(o,e){if(o&1&&(r(0,"span",18),C(1,je,1,2,"img",20)(2,Ue,1,1),a()),o&2){let t=e.$implicit;h("matTooltip",t.displayName),l(),g(t.photoURL?1:2)}}function He(o,e){if(o&1&&(r(0,"span",19),m(1),a()),o&2){let t=c(2);l(),k("+",t.assignedMembers.length-2)}}function Ge(o,e){if(o&1&&(r(0,"div",10),T(1,qe,3,2,"span",18,ke),C(3,He,2,1,"span",19),a()),o&2){let t=c();l(),M(t.assignedMembers.slice(0,2)),l(2),g(t.assignedMembers.length>2?3:-1)}}function Je(o,e){if(o&1){let t=f();r(0,"button",13),_("click",function(){p(t);let i=c();return u(i.onStart())}),r(1,"mat-icon"),m(2,"play_arrow"),a(),r(3,"span"),m(4,"\u05D4\u05EA\u05D7\u05DC \u05DC\u05E2\u05D1\u05D5\u05D3"),a()()}}function Ke(o,e){if(o&1){let t=f();r(0,"button",13),_("click",function(){p(t);let i=c();return u(i.onToggle())}),r(1,"mat-icon"),m(2,"check"),a(),r(3,"span"),m(4,"\u05E1\u05D9\u05D9\u05DD \u05DE\u05E9\u05D9\u05DE\u05D4"),a()()}}function Ye(o,e){if(o&1){let t=f();r(0,"div",21)(1,"mat-checkbox",23),_("change",function(){let i=p(t).$implicit,s=c(2);return u(s.onToggleSubtask(i))}),a(),r(2,"span",24),m(3),a(),r(4,"button",25),_("click",function(){let i=p(t).$implicit,s=c(2);return u(s.onDeleteSubtask(i))}),r(5,"mat-icon"),m(6,"close"),a()()()}if(o&2){let t=e.$implicit,n=c(2);l(),h("checked",t.isCompleted)("disabled",n.task.status==="completed"),l(),I("completed",t.isCompleted),l(),k(" ",t.text," "),l(),h("disabled",n.task.status==="completed")}}function Qe(o,e){if(o&1){let t=f();r(0,"div",22)(1,"mat-icon"),m(2,"add"),a(),r(3,"input",26),E("ngModelChange",function(i){p(t);let s=c(2);return b(s.newSubtaskText,i)||(s.newSubtaskText=i),u(i)}),_("keydown.enter",function(){p(t);let i=c(2);return u(i.addSubtask())}),a()()}if(o&2){let t=c(2);l(3),D("ngModel",t.newSubtaskText)}}function Xe(o,e){if(o&1&&(r(0,"div",15),T(1,Ye,7,6,"div",21,ke),C(3,Qe,4,1,"div",22),a()),o&2){let t=c();l(),M(t.task.subtasks),l(2),g(t.task.status!=="completed"?3:-1)}}var $t=class o{task;members=[];toggle=new G;start=new G;edit=new G;delete=new G;toggleSubtask=new G;addSubtaskEvent=new G;deleteSubtask=new G;showSubtasks=!1;newSubtaskText="";getPriorityMeta=Vt;get isOverdue(){return this.task.dueDate?this.task.dueDate.toDate()<new Date&&this.task.status!=="completed":!1}get completedSubtasks(){return this.task.subtasks.filter(e=>e.isCompleted).length}get assignedMembers(){return this.members.filter(e=>this.task.assignedTo.includes(e.id))}formatDueDate(e){let t=new Date,n=Math.ceil((e.getTime()-t.getTime())/(1e3*60*60*24));return n===0?"\u05D4\u05D9\u05D5\u05DD":n===1?"\u05DE\u05D7\u05E8":n===-1?"\u05D0\u05EA\u05DE\u05D5\u05DC":n<0?`\u05DC\u05E4\u05E0\u05D9 ${Math.abs(n)} \u05D9\u05DE\u05D9\u05DD`:n<=7?`\u05D1\u05E2\u05D5\u05D3 ${n} \u05D9\u05DE\u05D9\u05DD`:e.toLocaleDateString("he-IL",{day:"numeric",month:"short"})}toggleSubtasks(){this.showSubtasks=!this.showSubtasks}onToggle(){this.toggle.emit()}onStart(){this.start.emit()}onEdit(){this.edit.emit()}onDelete(){this.delete.emit()}onToggleSubtask(e){this.toggleSubtask.emit(e)}addSubtask(){this.newSubtaskText.trim()&&(this.addSubtaskEvent.emit(this.newSubtaskText.trim()),this.newSubtaskText="")}onDeleteSubtask(e){this.deleteSubtask.emit(e)}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=A({type:o,selectors:[["app-task-item"]],inputs:{task:"task",members:"members"},outputs:{toggle:"toggle",start:"start",edit:"edit",delete:"delete",toggleSubtask:"toggleSubtask",addSubtaskEvent:"addSubtaskEvent",deleteSubtask:"deleteSubtask"},decls:34,vars:18,consts:[["taskMenu","matMenu"],[1,"task-item"],[1,"task-row"],["color","primary",3,"change","checked"],[1,"task-content",3,"click"],[1,"task-title"],[1,"task-meta"],[1,"priority",3,"color"],[1,"due-date",3,"overdue"],[1,"subtask-count"],[1,"assigned-users"],["mat-icon-button","",1,"menu-btn",3,"matMenuTriggerFor"],["mat-menu-item",""],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-item",3,"click"],[1,"subtasks"],[1,"priority"],[1,"due-date"],[1,"avatar",3,"matTooltip"],[1,"avatar","more"],[3,"src","alt"],[1,"subtask-item"],[1,"add-subtask"],[3,"change","checked","disabled"],[1,"subtask-text"],["mat-icon-button","",1,"delete-subtask",3,"click","disabled"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05EA\u05EA-\u05DE\u05E9\u05D9\u05DE\u05D4...",1,"add-input",3,"ngModelChange","keydown.enter","ngModel"]],template:function(t,n){if(t&1){let i=f();r(0,"div",1)(1,"div",2)(2,"mat-checkbox",3),_("change",function(){return p(i),u(n.onToggle())}),a(),r(3,"div",4),_("click",function(){return p(i),u(n.onEdit())}),r(4,"span",5),m(5),a(),r(6,"div",6),C(7,Re,3,3,"span",7),C(8,ze,4,3,"span",8),C(9,We,4,2,"span",9),a()(),C(10,Ge,4,1,"div",10),r(11,"button",11)(12,"mat-icon"),m(13,"more_vert"),a()(),r(14,"mat-menu",null,0),C(16,Je,5,0,"button",12),C(17,Ke,5,0,"button",12),r(18,"button",13),_("click",function(){return p(i),u(n.onEdit())}),r(19,"mat-icon"),m(20,"edit"),a(),r(21,"span"),m(22,"\u05E2\u05E8\u05D5\u05DA"),a()(),r(23,"button",13),_("click",function(){return p(i),u(n.toggleSubtasks())}),r(24,"mat-icon"),m(25),a(),r(26,"span"),m(27),a()(),r(28,"button",14),_("click",function(){return p(i),u(n.onDelete())}),r(29,"mat-icon"),m(30,"delete"),a(),r(31,"span"),m(32,"\u05DE\u05D7\u05E7"),a()()()(),C(33,Xe,4,1,"div",15),a()}if(t&2){let i=O(15);I("completed",n.task.status==="completed")("in-progress",n.task.status==="in_progress")("overdue",n.isOverdue),l(2),h("checked",n.task.status==="completed"),l(3),y(n.task.title),l(2),g(n.task.priority!=="medium"?7:-1),l(),g(n.task.dueDate?8:-1),l(),g(n.task.subtasks.length>0?9:-1),l(),g(n.assignedMembers.length>0?10:-1),l(),h("matMenuTriggerFor",i),l(5),g(n.task.status==="pending"?16:-1),l(),g(n.task.status==="in_progress"?17:-1),l(8),y(n.showSubtasks?"expand_less":"expand_more"),l(2),k("",n.showSubtasks?"\u05D4\u05E1\u05EA\u05E8":"\u05D4\u05E6\u05D2"," \u05EA\u05EA\u05D9-\u05DE\u05E9\u05D9\u05DE\u05D5\u05EA"),l(6),g(n.showSubtasks&&(n.task.subtasks.length>0||n.task.status!=="completed")?33:-1)}},dependencies:[$,H,j,U,q,W,z,R,Y,dt,At,ot,nt,et,it,lt,ct,Ot],styles:[".task-item[_ngcontent-%COMP%]{background:var(--surface-primary);border:1px solid var(--border-subtle);border-radius:.75rem;transition:all .2s ease}.task-item[_ngcontent-%COMP%]:hover{border-color:var(--border-default)}.task-item.completed[_ngcontent-%COMP%]{opacity:.7}.task-item.completed[_ngcontent-%COMP%]   .task-title[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--text-tertiary)}.task-item.in-progress[_ngcontent-%COMP%]{border-color:var(--color-primary);border-inline-start-width:3px}.task-item.overdue[_ngcontent-%COMP%]:not(.completed){border-color:var(--color-error)}.task-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem}.task-content[_ngcontent-%COMP%]{flex:1;min-width:0;cursor:pointer}.task-title[_ngcontent-%COMP%]{display:block;font-weight:500;color:var(--text-primary);margin-bottom:.25rem}.task-meta[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;flex-wrap:wrap}.priority[_ngcontent-%COMP%], .due-date[_ngcontent-%COMP%], .subtask-count[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.125rem;font-size:.75rem}.priority[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .due-date[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .subtask-count[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:14px;width:14px;height:14px}.due-date[_ngcontent-%COMP%]{color:var(--text-secondary)}.due-date.overdue[_ngcontent-%COMP%]{color:var(--color-error)}.subtask-count[_ngcontent-%COMP%]{color:var(--text-secondary)}.assigned-users[_ngcontent-%COMP%]{display:flex;margin-inline-start:auto}.assigned-users[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:500;background:var(--color-primary);color:#fff;border:2px solid var(--surface-primary);margin-inline-start:-8px}.assigned-users[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]:first-child{margin-inline-start:0}.assigned-users[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}.assigned-users[_ngcontent-%COMP%]   .avatar.more[_ngcontent-%COMP%]{background:var(--surface-tertiary);color:var(--text-secondary)}.menu-btn[_ngcontent-%COMP%]{flex-shrink:0;color:var(--text-tertiary)}.subtasks[_ngcontent-%COMP%]{padding:0 1rem 1rem 3rem;display:flex;flex-direction:column;gap:.25rem}.subtask-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem}.subtask-item[_ngcontent-%COMP%]   .subtask-text[_ngcontent-%COMP%]{flex:1;font-size:.875rem}.subtask-item[_ngcontent-%COMP%]   .subtask-text.completed[_ngcontent-%COMP%]{text-decoration:line-through;color:var(--text-tertiary)}.subtask-item[_ngcontent-%COMP%]   .delete-subtask[_ngcontent-%COMP%]{opacity:0;color:var(--text-tertiary);transform:scale(.8)}.subtask-item[_ngcontent-%COMP%]   .delete-subtask[_ngcontent-%COMP%]:hover{color:var(--color-error)}.subtask-item[_ngcontent-%COMP%]:hover   .delete-subtask[_ngcontent-%COMP%]{opacity:1}.add-subtask[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;padding:.25rem 0;color:var(--text-tertiary)}.add-subtask[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.add-subtask[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;font-size:.875rem;outline:none;color:var(--text-primary)}.add-subtask[_ngcontent-%COMP%]   .add-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.delete-item[_ngcontent-%COMP%]{color:var(--color-error)}"]})};var ve=(o,e)=>e.id;function Ze(o,e){if(o&1&&(r(0,"mat-option",13)(1,"mat-icon"),m(2),a(),m(3),a()),o&2){let t=e.$implicit;h("value",t.id),l(),B("color",t.color),l(),y(t.icon),l(),k(" ",t.labelHe," ")}}function tn(o,e){if(o&1&&S(0,"img",26),o&2){let t=c().$implicit;h("src",t.photoURL,K)("alt",t.displayName)}}function en(o,e){if(o&1&&m(0),o&2){let t=c().$implicit;k(" ",t.displayName.charAt(0)," ")}}function nn(o,e){if(o&1){let t=f();r(0,"label",23)(1,"input",24),_("change",function(){let i=p(t).$implicit,s=c(2);return u(s.toggleAssignee(i.id))}),a(),r(2,"span",25),C(3,tn,1,2,"img",26)(4,en,1,1),a(),m(5),a()}if(o&2){let t=e.$implicit,n=c(2);I("selected",n.isAssigned(t.id)),l(),h("checked",n.isAssigned(t.id)),l(2),g(t.photoURL?3:4),l(2),k(" ",t.displayName," ")}}function on(o,e){if(o&1&&(r(0,"div",16)(1,"label",20),m(2,"\u05D4\u05E7\u05E6\u05D4 \u05DC\u05D7\u05D1\u05E8\u05D9 \u05DE\u05E9\u05E4\u05D7\u05D4"),a(),r(3,"div",21),T(4,nn,6,5,"label",22,ve),a()()),o&2){let t=c();l(4),M(t.familyService.members())}}var kt=class o{constructor(e){this.data=e}tasksService=v(rt);familyService=v(N);dialogRef=v(ce);priorities=It;isEdit=!1;isSubmitting=!1;formData={title:"",description:"",priority:"medium",dueDate:null,assignedTo:[]};ngOnInit(){if(this.data?.task){this.isEdit=!0;let e=this.data.task;this.formData={title:e.title,description:e.description||"",priority:e.priority,dueDate:e.dueDate?.toDate()||null,assignedTo:[...e.assignedTo]}}}isAssigned(e){return this.formData.assignedTo.includes(e)}toggleAssignee(e){let t=this.formData.assignedTo.indexOf(e);t>=0?this.formData.assignedTo.splice(t,1):this.formData.assignedTo.push(e)}submit(){return x(this,null,function*(){if(!this.isSubmitting){this.isSubmitting=!0;try{let e={title:this.formData.title.trim(),description:this.formData.description.trim(),priority:this.formData.priority,dueDate:this.formData.dueDate||void 0,assignedTo:this.formData.assignedTo};this.isEdit&&this.data?.task?yield this.tasksService.updateTask(this.data.topicId,this.data.task.id,e):yield this.tasksService.createTask(this.data.topicId,e),this.dialogRef.close(!0)}catch(e){console.error("Error saving task:",e)}finally{this.isSubmitting=!1}}})}close(){this.dialogRef.close()}static \u0275fac=function(t){return new(t||o)(Ut(le,8))};static \u0275cmp=A({type:o,selectors:[["app-task-form"]],decls:38,vars:10,consts:[["taskForm","ngForm"],["duePicker",""],[1,"task-form"],[1,"form-header"],["mat-icon-button","",3,"click"],[3,"ngSubmit"],[1,"form-content"],["appearance","outline",1,"full-width"],["matInput","","name","title","required","","placeholder","\u05DE\u05D4 \u05E6\u05E8\u05D9\u05DA \u05DC\u05E2\u05E9\u05D5\u05EA?",3,"ngModelChange","ngModel"],["matInput","","name","description","rows","2","placeholder","\u05E4\u05E8\u05D8\u05D9\u05DD \u05E0\u05D5\u05E1\u05E4\u05D9\u05DD...",3,"ngModelChange","ngModel"],[1,"form-row"],["appearance","outline",1,"half-width"],["name","priority",3,"ngModelChange","ngModel"],[3,"value"],["matInput","","name","dueDate",3,"ngModelChange","matDatepicker","ngModel"],["matSuffix","",3,"for"],[1,"assignees-section"],[1,"form-footer"],["mat-button","","type","button",3,"click"],["mat-flat-button","","color","primary","type","submit",3,"disabled"],[1,"section-label"],[1,"assignees-chips"],[1,"assignee-chip",3,"selected"],[1,"assignee-chip"],["type","checkbox",3,"change","checked"],[1,"avatar"],[3,"src","alt"]],template:function(t,n){if(t&1){let i=f();r(0,"div",2)(1,"header",3)(2,"h2"),m(3),a(),r(4,"button",4),_("click",function(){return p(i),u(n.close())}),r(5,"mat-icon"),m(6,"close"),a()()(),r(7,"form",5,0),_("ngSubmit",function(){return p(i),u(n.submit())}),r(9,"div",6)(10,"mat-form-field",7)(11,"mat-label"),m(12,"\u05DB\u05D5\u05EA\u05E8\u05EA"),a(),r(13,"input",8),E("ngModelChange",function(d){return p(i),b(n.formData.title,d)||(n.formData.title=d),u(d)}),a()(),r(14,"mat-form-field",7)(15,"mat-label"),m(16,"\u05EA\u05D9\u05D0\u05D5\u05E8 (\u05D0\u05D5\u05E4\u05E6\u05D9\u05D5\u05E0\u05DC\u05D9)"),a(),r(17,"textarea",9),E("ngModelChange",function(d){return p(i),b(n.formData.description,d)||(n.formData.description=d),u(d)}),a()(),r(18,"div",10)(19,"mat-form-field",11)(20,"mat-label"),m(21,"\u05E2\u05D3\u05D9\u05E4\u05D5\u05EA"),a(),r(22,"mat-select",12),E("ngModelChange",function(d){return p(i),b(n.formData.priority,d)||(n.formData.priority=d),u(d)}),T(23,Ze,4,5,"mat-option",13,ve),a()(),r(25,"mat-form-field",11)(26,"mat-label"),m(27,"\u05EA\u05D0\u05E8\u05D9\u05DA \u05D9\u05E2\u05D3"),a(),r(28,"input",14),E("ngModelChange",function(d){return p(i),b(n.formData.dueDate,d)||(n.formData.dueDate=d),u(d)}),a(),S(29,"mat-datepicker-toggle",15)(30,"mat-datepicker",null,1),a()(),C(32,on,6,0,"div",16),a(),r(33,"footer",17)(34,"button",18),_("click",function(){return p(i),u(n.close())}),m(35,"\u05D1\u05D9\u05D8\u05D5\u05DC"),a(),r(36,"button",19),m(37),a()()()()}if(t&2){let i=O(8),s=O(31);l(3),y(n.isEdit?"\u05E2\u05E8\u05D9\u05DB\u05EA \u05DE\u05E9\u05D9\u05DE\u05D4":"\u05DE\u05E9\u05D9\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4"),l(10),D("ngModel",n.formData.title),l(4),D("ngModel",n.formData.description),l(5),D("ngModel",n.formData.priority),l(),M(n.priorities),l(5),h("matDatepicker",s),D("ngModel",n.formData.dueDate),l(),h("for",s),l(3),g(n.familyService.members().length>0?32:-1),l(4),h("disabled",!i.valid||n.isSubmitting),l(),k(" ",n.isEdit?"\u05E9\u05DE\u05D5\u05E8":"\u05E6\u05D5\u05E8 \u05DE\u05E9\u05D9\u05DE\u05D4"," ")}},dependencies:[$,H,Zt,j,U,Qt,te,q,Xt,R,tt,Y,W,z,X,oe,ie,ee,ne,Q,Lt,me,Kt,_e,de,pe,ue,Yt,dt,mt],styles:[".task-form[_ngcontent-%COMP%]{display:flex;flex-direction:column;max-height:90vh}.form-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:1rem 1.5rem;border-bottom:1px solid var(--border-subtle)}.form-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.25rem;font-weight:600}.form-content[_ngcontent-%COMP%]{padding:1.5rem;overflow-y:auto;display:flex;flex-direction:column;gap:.5rem}.full-width[_ngcontent-%COMP%]{width:100%}.form-row[_ngcontent-%COMP%]{display:flex;gap:1rem}@media(max-width:480px){.form-row[_ngcontent-%COMP%]{flex-direction:column;gap:.5rem}}.half-width[_ngcontent-%COMP%]{flex:1}.section-label[_ngcontent-%COMP%]{display:block;font-size:.875rem;font-weight:500;color:var(--text-secondary);margin-bottom:.5rem}.assignees-section[_ngcontent-%COMP%]{margin-top:.5rem}.assignees-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.assignee-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--surface-secondary);border:1px solid var(--border-subtle);border-radius:9999px;cursor:pointer;transition:all .15s ease}.assignee-chip[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{display:none}.assignee-chip[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:500;background:var(--color-primary);color:#fff}.assignee-chip[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}.assignee-chip[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.assignee-chip.selected[_ngcontent-%COMP%]{background:var(--color-primary);color:#fff;border-color:var(--color-primary)}.assignee-chip.selected[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{background:#fff;color:var(--color-primary)}.form-footer[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;padding:1rem 1.5rem;border-top:1px solid var(--border-subtle)}"]})};var Wt=(o,e)=>e.id;function sn(o,e){if(o&1&&(r(0,"span",3),m(1),a()),o&2){let t=c();l(),J(" ",t.tasksService.completedCount(),"/",t.tasksService.totalCount()," ")}}function cn(o,e){o&1&&(r(0,"div",7),S(1,"mat-spinner",9),a())}function ln(o,e){if(o&1){let t=f();r(0,"app-task-item",19),_("toggle",function(){let i=p(t).$implicit,s=c(3);return u(s.toggleTask(i))})("start",function(){let i=p(t).$implicit,s=c(3);return u(s.startTask(i))})("edit",function(){let i=p(t).$implicit,s=c(3);return u(s.openEditDialog(i))})("delete",function(){let i=p(t).$implicit,s=c(3);return u(s.deleteTask(i))})("toggleSubtask",function(i){let s=p(t).$implicit,d=c(3);return u(d.toggleSubtask(s,i))})("addSubtaskEvent",function(i){let s=p(t).$implicit,d=c(3);return u(d.addSubtask(s,i))})("deleteSubtask",function(i){let s=p(t).$implicit,d=c(3);return u(d.deleteSubtask(s,i))}),a()}if(o&2){let t=e.$implicit,n=c(3);h("task",t)("members",n.familyService.members())}}function mn(o,e){if(o&1&&(r(0,"div",15)(1,"h4",16)(2,"mat-icon"),m(3,"pending"),a(),m(4),a(),r(5,"div",17),T(6,ln,1,2,"app-task-item",18,Wt),a()()),o&2){let t=c(2);l(4),k(" \u05D1\u05D1\u05D9\u05E6\u05D5\u05E2 (",t.tasksService.groupedTasks().inProgress.length,") "),l(2),M(t.tasksService.groupedTasks().inProgress)}}function dn(o,e){if(o&1){let t=f();r(0,"app-task-item",19),_("toggle",function(){let i=p(t).$implicit,s=c(3);return u(s.toggleTask(i))})("start",function(){let i=p(t).$implicit,s=c(3);return u(s.startTask(i))})("edit",function(){let i=p(t).$implicit,s=c(3);return u(s.openEditDialog(i))})("delete",function(){let i=p(t).$implicit,s=c(3);return u(s.deleteTask(i))})("toggleSubtask",function(i){let s=p(t).$implicit,d=c(3);return u(d.toggleSubtask(s,i))})("addSubtaskEvent",function(i){let s=p(t).$implicit,d=c(3);return u(d.addSubtask(s,i))})("deleteSubtask",function(i){let s=p(t).$implicit,d=c(3);return u(d.deleteSubtask(s,i))}),a()}if(o&2){let t=e.$implicit,n=c(3);h("task",t)("members",n.familyService.members())}}function pn(o,e){if(o&1&&(r(0,"div",15)(1,"h4",20)(2,"mat-icon"),m(3,"radio_button_unchecked"),a(),m(4),a(),r(5,"div",17),T(6,dn,1,2,"app-task-item",18,Wt),a()()),o&2){let t=c(2);l(4),k(" \u05DE\u05DE\u05EA\u05D9\u05E0\u05D5\u05EA (",t.tasksService.groupedTasks().pending.length,") "),l(2),M(t.tasksService.groupedTasks().pending)}}function un(o,e){if(o&1){let t=f();r(0,"app-task-item",24),_("toggle",function(){let i=p(t).$implicit,s=c(4);return u(s.toggleTask(i))})("edit",function(){let i=p(t).$implicit,s=c(4);return u(s.openEditDialog(i))})("delete",function(){let i=p(t).$implicit,s=c(4);return u(s.deleteTask(i))}),a()}if(o&2){let t=e.$implicit,n=c(4);h("task",t)("members",n.familyService.members())}}function _n(o,e){if(o&1&&(r(0,"div",17),T(1,un,1,2,"app-task-item",18,Wt),a()),o&2){let t=c(3);l(),M(t.tasksService.groupedTasks().completed)}}function Cn(o,e){if(o&1){let t=f();r(0,"div",15)(1,"button",21),_("click",function(){p(t);let i=c(2);return u(i.toggleCompleted())}),r(2,"h4",22)(3,"mat-icon"),m(4,"check_circle"),a(),m(5),a(),r(6,"mat-icon",23),m(7),a()(),C(8,_n,3,0,"div",17),a()}if(o&2){let t=c(2);l(5),k(" \u05D4\u05D5\u05E9\u05DC\u05DE\u05D5 (",t.tasksService.groupedTasks().completed.length,") "),l(2),k(" ",t.showCompleted()?"expand_less":"expand_more"," "),l(),g(t.showCompleted()?8:-1)}}function gn(o,e){if(o&1&&(r(0,"div",10)(1,"div",11),S(2,"div",12),a(),r(3,"span",13),m(4),Tt(5,"number"),a()(),r(6,"div",14),C(7,mn,8,1,"div",15),C(8,pn,8,1,"div",15),C(9,Cn,9,3,"div",15),a()),o&2){let t=c();l(2),B("width",t.tasksService.progress(),"%"),l(2),k("",Mt(5,6,t.tasksService.progress(),"1.0-0"),"%"),l(3),g(t.tasksService.groupedTasks().inProgress.length>0?7:-1),l(),g(t.tasksService.groupedTasks().pending.length>0?8:-1),l(),g(t.tasksService.groupedTasks().completed.length>0?9:-1)}}function fn(o,e){o&1&&(r(0,"div",8)(1,"mat-icon"),m(2,"task_alt"),a(),r(3,"p"),m(4,"\u05D0\u05D9\u05DF \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA \u05E2\u05D3\u05D9\u05D9\u05DF"),a(),r(5,"span"),m(6,"\u05D4\u05E9\u05EA\u05DE\u05E9\u05D5 \u05D1\u05E9\u05D5\u05E8\u05D4 \u05DC\u05DE\u05E2\u05DC\u05D4 \u05DC\u05D4\u05D5\u05E1\u05E4\u05D4 \u05DE\u05D4\u05D9\u05E8\u05D4"),a()())}var Nt=class o{topicId;tasksService=v(rt);familyService=v(N);dialog=v(Ft);snackBar=v(pt);quickTaskTitle="";showCompleted=w(!1);toggleCompleted(){this.showCompleted.update(e=>!e)}quickAddTask(){return x(this,null,function*(){if(this.quickTaskTitle.trim())try{yield this.tasksService.createTask(this.topicId,{title:this.quickTaskTitle.trim()}),this.quickTaskTitle=""}catch(e){this.snackBar.open(e.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}openCreateDialog(){this.dialog.open(kt,{width:"100%",maxWidth:"500px",data:{topicId:this.topicId}}).afterClosed().subscribe(t=>{t&&this.snackBar.open("\u05D4\u05DE\u05E9\u05D9\u05DE\u05D4 \u05E0\u05D5\u05E6\u05E8\u05D4","",{duration:2e3})})}openEditDialog(e){this.dialog.open(kt,{width:"100%",maxWidth:"500px",data:{topicId:this.topicId,task:e}}).afterClosed().subscribe(n=>{n&&this.snackBar.open("\u05D4\u05DE\u05E9\u05D9\u05DE\u05D4 \u05E2\u05D5\u05D3\u05DB\u05E0\u05D4","",{duration:2e3})})}toggleTask(e){return x(this,null,function*(){try{yield this.tasksService.toggleTaskStatus(this.topicId,e.id)}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}startTask(e){return x(this,null,function*(){try{yield this.tasksService.startTask(this.topicId,e.id)}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}deleteTask(e){return x(this,null,function*(){try{yield this.tasksService.deleteTask(this.topicId,e.id),this.snackBar.open("\u05D4\u05DE\u05E9\u05D9\u05DE\u05D4 \u05E0\u05DE\u05D7\u05E7\u05D4","",{duration:2e3})}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}toggleSubtask(e,t){return x(this,null,function*(){try{yield this.tasksService.toggleSubtask(this.topicId,e.id,t.id)}catch(n){this.snackBar.open(n.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}addSubtask(e,t){return x(this,null,function*(){try{yield this.tasksService.addSubtask(this.topicId,e.id,t)}catch(n){this.snackBar.open(n.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}deleteSubtask(e,t){return x(this,null,function*(){try{yield this.tasksService.deleteSubtask(this.topicId,e.id,t.id)}catch(n){this.snackBar.open(n.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=A({type:o,selectors:[["app-task-list"]],inputs:{topicId:"topicId"},decls:17,vars:3,consts:[[1,"task-list"],[1,"list-header"],[1,"header-actions"],[1,"task-count"],["mat-stroked-button","",3,"click"],[1,"quick-add"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05DE\u05E9\u05D9\u05DE\u05D4 \u05DE\u05D4\u05D9\u05E8\u05D4...",1,"quick-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"loading"],[1,"empty-state"],["diameter","32"],[1,"progress-section"],[1,"progress-bar"],[1,"progress"],[1,"progress-text"],[1,"task-groups"],[1,"task-group"],[1,"group-title","in-progress"],[1,"tasks"],[3,"task","members"],[3,"toggle","start","edit","delete","toggleSubtask","addSubtaskEvent","deleteSubtask","task","members"],[1,"group-title","pending"],[1,"group-header-btn",3,"click"],[1,"group-title","completed"],[1,"chevron"],[3,"toggle","edit","delete","task","members"]],template:function(t,n){t&1&&(r(0,"div",0)(1,"div",1)(2,"h3"),m(3,"\u05DE\u05E9\u05D9\u05DE\u05D5\u05EA"),a(),r(4,"div",2),C(5,sn,2,2,"span",3),r(6,"button",4),_("click",function(){return n.openCreateDialog()}),r(7,"mat-icon"),m(8,"add"),a(),m(9," \u05DE\u05E9\u05D9\u05DE\u05D4 \u05D7\u05D3\u05E9\u05D4 "),a()()(),r(10,"div",5)(11,"mat-icon"),m(12,"add_task"),a(),r(13,"input",6),E("ngModelChange",function(s){return b(n.quickTaskTitle,s)||(n.quickTaskTitle=s),s}),_("keydown.enter",function(){return n.quickAddTask()}),a()(),C(14,cn,2,0,"div",7)(15,gn,10,9)(16,fn,7,0,"div",8),a()),t&2&&(l(5),g(n.tasksService.totalCount()>0?5:-1),l(8),D("ngModel",n.quickTaskTitle),l(),g(n.tasksService.isLoading()?14:n.tasksService.totalCount()>0?15:16))},dependencies:[$,H,j,U,q,W,z,R,tt,X,Q,mt,ut,Pt,St,$t,Dt],styles:[".task-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.list-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.list-header[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:600}.list-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.list-header[_ngcontent-%COMP%]   .task-count[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-secondary);font-weight:500}.quick-add[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem;padding:.75rem 1rem;background:var(--surface-secondary);border:1px dashed var(--border-subtle);border-radius:.75rem}.quick-add[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--text-tertiary)}.quick-add[_ngcontent-%COMP%]   .quick-input[_ngcontent-%COMP%]{flex:1;border:none;background:transparent;font-size:.9375rem;outline:none;color:var(--text-primary)}.quick-add[_ngcontent-%COMP%]   .quick-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:2rem}.progress-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.progress-bar[_ngcontent-%COMP%]{flex:1;height:6px;background:var(--surface-tertiary);border-radius:3px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:100%;background:var(--color-success);transition:width .3s ease;border-radius:3px}.progress-text[_ngcontent-%COMP%]{font-size:.75rem;font-weight:600;color:var(--color-success);min-width:36px}.task-groups[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.task-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.group-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0;font-size:.875rem;font-weight:600}.group-title[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.group-title.in-progress[_ngcontent-%COMP%]{color:var(--color-primary)}.group-title.pending[_ngcontent-%COMP%]{color:var(--text-secondary)}.group-title.completed[_ngcontent-%COMP%]{color:var(--color-success)}.group-header-btn[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;width:100%;background:none;border:none;cursor:pointer;padding:.25rem 0}.group-header-btn[_ngcontent-%COMP%]   .chevron[_ngcontent-%COMP%]{color:var(--text-tertiary)}.tasks[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem;text-align:center;gap:.5rem}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:var(--text-tertiary)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-tertiary)}"]})};var ye=(o,e)=>e.id;function xn(o,e){o&1&&(r(0,"div",4)(1,"span"),m(2,"\u05D8\u05D5\u05E2\u05DF \u05EA\u05D2\u05D5\u05D1\u05D5\u05EA..."),a()())}function hn(o,e){if(o&1&&S(0,"img",7),o&2){let t=c(2);h("src",t.currentUserPhoto,K)}}function kn(o,e){if(o&1&&m(0),o&2){let t=c(2);k(" ",t.currentUserInitial," ")}}function vn(o,e){if(o&1&&S(0,"img",15),o&2){let t,n,i=c().$implicit,s=c(3);h("src",(t=s.getMember(i.createdBy))==null?null:t.photoURL,K)("alt",(n=s.getMember(i.createdBy))==null?null:n.displayName)}}function yn(o,e){if(o&1&&m(0),o&2){let t,n=c().$implicit,i=c(3);k(" ",((t=i.getMember(n.createdBy))==null||t.displayName==null?null:t.displayName.charAt(0))||"?"," ")}}function Tn(o,e){o&1&&(r(0,"span",20),m(1,"(\u05E0\u05E2\u05E8\u05DA)"),a())}function Mn(o,e){if(o&1){let t=f();r(0,"div",21)(1,"textarea",32),E("ngModelChange",function(i){p(t);let s=c(4);return b(s.editingContent,i)||(s.editingContent=i),u(i)}),a(),r(2,"div",33)(3,"button",34),_("click",function(){p(t);let i=c(4);return u(i.cancelEdit())}),m(4,"\u05D1\u05D9\u05D8\u05D5\u05DC"),a(),r(5,"button",35),_("click",function(){p(t);let i=c().$implicit,s=c(3);return u(s.saveEdit(i))}),m(6,"\u05E9\u05DE\u05D5\u05E8"),a()()()}if(o&2){let t=c(4);l(),D("ngModel",t.editingContent)}}function Dn(o,e){if(o&1&&(r(0,"p",22),m(1),a()),o&2){let t=c().$implicit;l(),y(t.content)}}function bn(o,e){if(o&1){let t=f();r(0,"button",36),_("click",function(){let i=p(t).$implicit,s=c().$implicit,d=c(3);return u(d.toggleReaction(s,i))}),m(1),a()}if(o&2){let t=e.$implicit,n=c().$implicit,i=c(3);I("my-reaction",i.hasMyReaction(n,t)),h("matTooltip",i.getReactionTooltip(n,t)),l(),J(" ",t," ",i.getReactionCount(n,t)," ")}}function En(o,e){if(o&1){let t=f();r(0,"button",37),_("click",function(){let i=p(t).$implicit,s=c().$implicit,d=c(3);return u(d.toggleReaction(s,i))}),m(1),a()}if(o&2){let t=e.$implicit;l(),k(" ",t," ")}}function wn(o,e){if(o&1){let t=f();r(0,"button",38)(1,"mat-icon"),m(2,"more_vert"),a()(),r(3,"mat-menu",null,1)(5,"button",39),_("click",function(){p(t);let i=c().$implicit,s=c(3);return u(s.startEdit(i))}),r(6,"mat-icon"),m(7,"edit"),a(),r(8,"span"),m(9,"\u05E2\u05E8\u05D5\u05DA"),a()(),r(10,"button",40),_("click",function(){p(t);let i=c().$implicit,s=c(3);return u(s.deleteComment(i))}),r(11,"mat-icon"),m(12,"delete"),a(),r(13,"span"),m(14,"\u05DE\u05D7\u05E7"),a()()()}if(o&2){let t=O(4);h("matMenuTriggerFor",t)}}function Sn(o,e){if(o&1){let t=f();r(0,"div",30)(1,"textarea",41),E("ngModelChange",function(i){p(t);let s=c(4);return b(s.replyText,i)||(s.replyText=i),u(i)}),a(),r(2,"div",42)(3,"button",34),_("click",function(){p(t);let i=c(4);return u(i.cancelReply())}),m(4,"\u05D1\u05D9\u05D8\u05D5\u05DC"),a(),r(5,"button",10),_("click",function(){p(t);let i=c().$implicit,s=c(3);return u(s.addReply(i.id))}),m(6," \u05E9\u05DC\u05D7 "),a()()()}if(o&2){let t=c(4);l(),D("ngModel",t.replyText),l(4),h("disabled",!t.replyText.trim())}}function Pn(o,e){if(o&1&&S(0,"img",15),o&2){let t,n,i=c().$implicit,s=c(5);h("src",(t=s.getMember(i.createdBy))==null?null:t.photoURL,K)("alt",(n=s.getMember(i.createdBy))==null?null:n.displayName)}}function On(o,e){if(o&1&&m(0),o&2){let t,n=c().$implicit,i=c(5);k(" ",((t=i.getMember(n.createdBy))==null||t.displayName==null?null:t.displayName.charAt(0))||"?"," ")}}function In(o,e){o&1&&(r(0,"span",20),m(1,"(\u05E0\u05E2\u05E8\u05DA)"),a())}function Vn(o,e){if(o&1){let t=f();r(0,"div",21)(1,"textarea",32),E("ngModelChange",function(i){p(t);let s=c(6);return b(s.editingContent,i)||(s.editingContent=i),u(i)}),a(),r(2,"div",33)(3,"button",34),_("click",function(){p(t);let i=c(6);return u(i.cancelEdit())}),m(4,"\u05D1\u05D9\u05D8\u05D5\u05DC"),a(),r(5,"button",35),_("click",function(){p(t);let i=c().$implicit,s=c(5);return u(s.saveEdit(i))}),m(6,"\u05E9\u05DE\u05D5\u05E8"),a()()()}if(o&2){let t=c(6);l(),D("ngModel",t.editingContent)}}function Fn(o,e){if(o&1&&(r(0,"p",22),m(1),a()),o&2){let t=c().$implicit;l(),y(t.content)}}function Ln(o,e){if(o&1){let t=f();r(0,"button",46),_("click",function(){let i=p(t).$implicit,s=c().$implicit,d=c(5);return u(d.toggleReaction(s,i))}),m(1),a()}if(o&2){let t=e.$implicit,n=c().$implicit,i=c(5);I("my-reaction",i.hasMyReaction(n,t)),l(),J(" ",t," ",i.getReactionCount(n,t)," ")}}function An(o,e){if(o&1){let t=f();r(0,"button",38)(1,"mat-icon"),m(2,"more_vert"),a()(),r(3,"mat-menu",null,2)(5,"button",39),_("click",function(){p(t);let i=c().$implicit,s=c(5);return u(s.startEdit(i))}),r(6,"mat-icon"),m(7,"edit"),a(),r(8,"span"),m(9,"\u05E2\u05E8\u05D5\u05DA"),a()(),r(10,"button",40),_("click",function(){p(t);let i=c().$implicit,s=c(5);return u(s.deleteComment(i))}),r(11,"mat-icon"),m(12,"delete"),a(),r(13,"span"),m(14,"\u05DE\u05D7\u05E7"),a()()()}if(o&2){let t=O(4);h("matMenuTriggerFor",t)}}function Bn(o,e){if(o&1&&(r(0,"div",43)(1,"div",44),C(2,Pn,1,2,"img",15)(3,On,1,1),a(),r(4,"div",16)(5,"div",17)(6,"span",18),m(7),a(),r(8,"span",19),m(9),a(),C(10,In,2,0,"span",20),a(),C(11,Vn,7,1,"div",21)(12,Fn,2,1,"p",22),r(13,"div",23),T(14,Ln,2,4,"button",45,yt),C(16,An,15,1),a()()()),o&2){let t,n,i=e.$implicit,s=c(5);l(2),g((t=s.getMember(i.createdBy))!=null&&t.photoURL?2:3),l(5),y(((n=s.getMember(i.createdBy))==null?null:n.displayName)||"\u05DE\u05E9\u05EA\u05DE\u05E9"),l(2),y(i.createdAt?s.formatTime(i.createdAt.toDate()):""),l(),g(i.isEdited?10:-1),l(),g(s.editingCommentId()===i.id?11:12),l(3),M(s.getReactionEmojis(i)),l(2),g(s.canEditComment(i)?16:-1)}}function $n(o,e){if(o&1&&(r(0,"div",31),T(1,Bn,17,6,"div",43,ye),a()),o&2){let t=c().$implicit,n=c(3);l(),M(n.commentsService.getReplies(t.id))}}function Nn(o,e){if(o&1){let t=f();r(0,"div",13)(1,"div",14)(2,"div",6),C(3,vn,1,2,"img",15)(4,yn,1,1),a(),r(5,"div",16)(6,"div",17)(7,"span",18),m(8),a(),r(9,"span",19),m(10),a(),C(11,Tn,2,0,"span",20),a(),C(12,Mn,7,1,"div",21)(13,Dn,2,1,"p",22),r(14,"div",23),T(15,bn,2,5,"button",24,yt),r(17,"button",25)(18,"mat-icon"),m(19,"add_reaction"),a()(),r(20,"mat-menu",26,0)(22,"div",27),T(23,En,2,1,"button",28,yt),a()(),r(25,"button",29),_("click",function(){let i=p(t).$implicit,s=c(3);return u(s.toggleReply(i.id))}),r(26,"mat-icon"),m(27,"reply"),a(),m(28," \u05D4\u05D2\u05D1 "),a(),C(29,wn,15,1),a()()(),C(30,Sn,7,2,"div",30),C(31,$n,3,0,"div",31),a()}if(o&2){let t,n,i=e.$implicit,s=O(21),d=c(3);l(3),g((t=d.getMember(i.createdBy))!=null&&t.photoURL?3:4),l(5),y(((n=d.getMember(i.createdBy))==null?null:n.displayName)||"\u05DE\u05E9\u05EA\u05DE\u05E9"),l(2),y(i.createdAt?d.formatTime(i.createdAt.toDate()):""),l(),g(i.isEdited?11:-1),l(),g(d.editingCommentId()===i.id?12:13),l(3),M(d.getReactionEmojis(i)),l(2),h("matMenuTriggerFor",s),l(6),M(d.availableEmojis),l(6),g(d.canEditComment(i)?29:-1),l(),g(d.replyingToId()===i.id?30:-1),l(),g(i.replyCount>0?31:-1)}}function Rn(o,e){if(o&1&&(r(0,"div",11),T(1,Nn,32,9,"div",13,ye),a()),o&2){let t=c(2);l(),M(t.commentsService.topLevelComments())}}function zn(o,e){o&1&&(r(0,"div",12)(1,"mat-icon"),m(2,"chat_bubble_outline"),a(),r(3,"p"),m(4,"\u05D0\u05D9\u05DF \u05EA\u05D2\u05D5\u05D1\u05D5\u05EA \u05E2\u05D3\u05D9\u05D9\u05DF"),a(),r(5,"span"),m(6,"\u05D4\u05D9\u05D5 \u05D4\u05E8\u05D0\u05E9\u05D5\u05E0\u05D9\u05DD \u05DC\u05D4\u05D2\u05D9\u05D1!"),a()())}function Wn(o,e){if(o&1){let t=f();r(0,"div",5)(1,"div",6),C(2,hn,1,1,"img",7)(3,kn,1,1),a(),r(4,"div",8)(5,"textarea",9),E("ngModelChange",function(i){p(t);let s=c();return b(s.newCommentText,i)||(s.newCommentText=i),u(i)}),_("keydown.enter",function(i){p(t);let s=c();return u(i.ctrlKey&&s.addComment())}),a(),r(6,"button",10),_("click",function(){p(t);let i=c();return u(i.addComment())}),r(7,"mat-icon"),m(8,"send"),a(),m(9," \u05E9\u05DC\u05D7 "),a()()(),C(10,Rn,3,0,"div",11)(11,zn,7,0,"div",12)}if(o&2){let t=c();l(2),g(t.currentUserPhoto?2:3),l(3),D("ngModel",t.newCommentText),l(),h("disabled",!t.newCommentText.trim()),l(4),g(t.commentsService.topLevelComments().length>0?10:11)}}var jn=["\u{1F44D}","\u2764\uFE0F","\u{1F60A}","\u{1F389}","\u{1F44F}","\u{1F914}"],Rt=class o{topicId;commentsService=v(_t);familyService=v(N);authService=v(st);snackBar=v(pt);availableEmojis=jn;newCommentText="";replyText="";replyingToId=w(null);editingCommentId=w(null);editingContent="";get currentUserPhoto(){let e=this.authService.userId();return e?this.familyService.members().find(n=>n.id===e)?.photoURL:void 0}get currentUserInitial(){let e=this.authService.userId();return e&&this.familyService.members().find(n=>n.id===e)?.displayName?.charAt(0)||"?"}getMember(e){return this.familyService.members().find(t=>t.id===e)}formatTime(e){let n=new Date().getTime()-e.getTime(),i=Math.floor(n/6e4),s=Math.floor(i/60),d=Math.floor(s/24);return i<1?"\u05E2\u05DB\u05E9\u05D9\u05D5":i<60?`\u05DC\u05E4\u05E0\u05D9 ${i} \u05D3\u05E7\u05D5\u05EA`:s<24?`\u05DC\u05E4\u05E0\u05D9 ${s} \u05E9\u05E2\u05D5\u05EA`:d<7?`\u05DC\u05E4\u05E0\u05D9 ${d} \u05D9\u05DE\u05D9\u05DD`:e.toLocaleDateString("he-IL",{day:"numeric",month:"short"})}canEditComment(e){let t=this.authService.userId();return e.createdBy===t||this.familyService.isAdmin()}getReactionEmojis(e){return Object.keys(e.reactions||{})}getReactionCount(e,t){return e.reactions?.[t]?.length||0}hasMyReaction(e,t){let n=this.authService.userId();return n&&e.reactions?.[t]?.includes(n)||!1}getReactionTooltip(e,t){return(e.reactions?.[t]||[]).map(s=>this.getMember(s)?.displayName||"\u05DE\u05E9\u05EA\u05DE\u05E9").join(", ")}toggleReaction(e,t){return x(this,null,function*(){try{yield this.commentsService.toggleReaction(this.topicId,e.id,t)}catch(n){this.snackBar.open(n.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}addComment(){return x(this,null,function*(){if(this.newCommentText.trim())try{yield this.commentsService.createComment(this.topicId,{content:this.newCommentText.trim()}),this.newCommentText=""}catch(e){this.snackBar.open(e.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}toggleReply(e){this.replyingToId()===e?(this.replyingToId.set(null),this.replyText=""):(this.replyingToId.set(e),this.replyText="")}cancelReply(){this.replyingToId.set(null),this.replyText=""}addReply(e){return x(this,null,function*(){if(this.replyText.trim())try{yield this.commentsService.createComment(this.topicId,{content:this.replyText.trim(),parentCommentId:e}),this.replyText="",this.replyingToId.set(null)}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}startEdit(e){this.editingCommentId.set(e.id),this.editingContent=e.content}cancelEdit(){this.editingCommentId.set(null),this.editingContent=""}saveEdit(e){return x(this,null,function*(){if(this.editingContent.trim())try{yield this.commentsService.updateComment(this.topicId,e.id,this.editingContent),this.editingCommentId.set(null),this.editingContent=""}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}deleteComment(e){return x(this,null,function*(){try{yield this.commentsService.deleteComment(this.topicId,e.id),this.snackBar.open("\u05D4\u05EA\u05D2\u05D5\u05D1\u05D4 \u05E0\u05DE\u05D7\u05E7\u05D4","",{duration:2e3})}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=A({type:o,selectors:[["app-comment-thread"]],inputs:{topicId:"topicId"},decls:3,vars:1,consts:[["emojiMenu","matMenu"],["commentMenu","matMenu"],["replyMenu","matMenu"],[1,"comment-thread"],[1,"loading"],[1,"new-comment"],[1,"comment-avatar"],["alt","You",3,"src"],[1,"comment-input-wrapper"],["placeholder","\u05D4\u05D5\u05E1\u05E3 \u05EA\u05D2\u05D5\u05D1\u05D4...","rows","2",1,"comment-input",3,"ngModelChange","keydown.enter","ngModel"],["mat-flat-button","","color","primary",3,"click","disabled"],[1,"comments-list"],[1,"empty-state"],[1,"comment-item"],[1,"comment-main"],[3,"src","alt"],[1,"comment-content"],[1,"comment-header"],[1,"author"],[1,"time"],[1,"edited"],[1,"edit-area"],[1,"comment-text"],[1,"reactions-row"],[1,"reaction-chip",3,"my-reaction","matTooltip"],["mat-icon-button","",1,"add-reaction-btn",3,"matMenuTriggerFor"],[1,"emoji-menu"],[1,"emoji-grid"],["mat-icon-button",""],["mat-button","",1,"reply-btn",3,"click"],[1,"reply-input-wrapper"],[1,"replies"],["rows","2",1,"edit-input",3,"ngModelChange","ngModel"],[1,"edit-actions"],["mat-button","",3,"click"],["mat-flat-button","","color","primary",3,"click"],[1,"reaction-chip",3,"click","matTooltip"],["mat-icon-button","",3,"click"],["mat-icon-button","",1,"menu-btn",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-item",3,"click"],["placeholder","\u05DB\u05EA\u05D5\u05D1 \u05EA\u05D2\u05D5\u05D1\u05D4...","rows","2",1,"reply-input",3,"ngModelChange","ngModel"],[1,"reply-actions"],[1,"reply-item"],[1,"comment-avatar","small"],[1,"reaction-chip",3,"my-reaction"],[1,"reaction-chip",3,"click"]],template:function(t,n){t&1&&(r(0,"div",3),C(1,xn,3,0,"div",4)(2,Wn,12,4),a()),t&2&&(l(),g(n.commentsService.isLoading()?1:2))},dependencies:[$,H,j,U,q,W,z,R,tt,Y,X,Q,ot,nt,et,it,lt,ct,ut],styles:[".comment-thread[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:1rem;color:var(--text-secondary)}.new-comment[_ngcontent-%COMP%]{display:flex;gap:.75rem;padding:1rem;background:var(--surface-secondary);border-radius:.75rem}.comment-input-wrapper[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:.5rem}.comment-input[_ngcontent-%COMP%], .reply-input[_ngcontent-%COMP%], .edit-input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid var(--border-subtle);border-radius:.5rem;font-family:inherit;font-size:.9375rem;resize:none;background:var(--surface-primary);color:var(--text-primary)}.comment-input[_ngcontent-%COMP%]:focus, .reply-input[_ngcontent-%COMP%]:focus, .edit-input[_ngcontent-%COMP%]:focus{outline:none;border-color:var(--color-primary)}.comment-input[_ngcontent-%COMP%]::placeholder, .reply-input[_ngcontent-%COMP%]::placeholder, .edit-input[_ngcontent-%COMP%]::placeholder{color:var(--text-tertiary)}.comment-input-wrapper[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{align-self:flex-end}.comment-avatar[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:1rem;font-weight:600;background:var(--color-primary);color:#fff;flex-shrink:0}.comment-avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:50%;object-fit:cover}.comment-avatar.small[_ngcontent-%COMP%]{width:32px;height:32px;font-size:.875rem}.comments-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.comment-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.comment-main[_ngcontent-%COMP%]{display:flex;gap:.75rem}.comment-content[_ngcontent-%COMP%]{flex:1;min-width:0}.comment-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-bottom:.25rem}.author[_ngcontent-%COMP%]{font-weight:600;color:var(--text-primary)}.time[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary)}.edited[_ngcontent-%COMP%]{font-size:.75rem;color:var(--text-tertiary);font-style:italic}.comment-text[_ngcontent-%COMP%]{margin:0;color:var(--text-primary);line-height:1.5;white-space:pre-wrap}.edit-area[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem}.edit-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem}.reactions-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin-top:.5rem;flex-wrap:wrap}.reaction-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;padding:.25rem .5rem;background:var(--surface-secondary);border:1px solid var(--border-subtle);border-radius:9999px;font-size:.875rem;cursor:pointer;transition:all .15s ease}.reaction-chip[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.reaction-chip.my-reaction[_ngcontent-%COMP%]{background:color-mix(in srgb,var(--color-primary) 15%,transparent);border-color:var(--color-primary)}.add-reaction-btn[_ngcontent-%COMP%]{color:var(--text-tertiary);transform:scale(.9)}.reply-btn[_ngcontent-%COMP%]{color:var(--text-secondary);font-size:.875rem}.reply-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.menu-btn[_ngcontent-%COMP%]{color:var(--text-tertiary);opacity:0;transition:opacity .15s ease}.comment-main[_ngcontent-%COMP%]:hover   .menu-btn[_ngcontent-%COMP%], .reply-item[_ngcontent-%COMP%]:hover   .menu-btn[_ngcontent-%COMP%]{opacity:1}.reply-input-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.5rem;margin-inline-start:52px;padding:.75rem;background:var(--surface-secondary);border-radius:.5rem}.reply-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.5rem}.replies[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:.75rem;margin-inline-start:52px;padding-inline-start:1rem;border-inline-start:2px solid var(--border-subtle)}.reply-item[_ngcontent-%COMP%]{display:flex;gap:.75rem}.empty-state[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem;text-align:center;gap:.5rem}.empty-state[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:40px;width:40px;height:40px;color:var(--text-tertiary)}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-weight:500;color:var(--text-secondary)}.empty-state[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-size:.875rem;color:var(--text-tertiary)}.delete-item[_ngcontent-%COMP%]{color:var(--color-error)}  .emoji-menu .mat-mdc-menu-content{padding:.5rem}.emoji-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:.25rem}.emoji-grid[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-size:1.25rem}"]})};var jt=(o,e)=>e.id;function Un(o,e){o&1&&(r(0,"div",5),S(1,"mat-spinner",7),r(2,"p"),m(3,"\u05D8\u05D5\u05E2\u05DF \u05E0\u05D5\u05E9\u05D0..."),a()())}function qn(o,e){if(o&1){let t=f();r(0,"input",40,3),E("ngModelChange",function(i){p(t);let s=c(2);return b(s.editingTitle,i)||(s.editingTitle=i),u(i)}),_("blur",function(){p(t);let i=c(2);return u(i.saveTitle())})("keydown.enter",function(){p(t);let i=c(2);return u(i.saveTitle())})("keydown.escape",function(){p(t);let i=c(2);return u(i.cancelTitleEdit())}),a()}if(o&2){let t=c(2);D("ngModel",t.editingTitle)}}function Hn(o,e){o&1&&(r(0,"mat-icon",42),m(1,"push_pin"),a())}function Gn(o,e){if(o&1){let t=f();r(0,"h1",41),_("click",function(){p(t);let i=c(2);return u(i.startTitleEdit())}),C(1,Hn,2,0,"mat-icon",42),m(2),a()}if(o&2){let t=c();l(),g(t.isPinned?1:-1),l(),k(" ",t.title," ")}}function Jn(o,e){if(o&1&&(r(0,"span",43)(1,"mat-icon"),m(2,"event"),a(),m(3),a()),o&2){let t=c(),n=c();I("overdue",n.isOverdue(t)),l(3),k(" ",n.formatDate(t.targetDate.toDate())," ")}}function Kn(o,e){if(o&1&&(r(0,"span",19)(1,"mat-icon"),m(2,"check_box"),a(),m(3),a()),o&2){let t=c();l(3),J(" ",t.completedTaskCount,"/",t.taskCount," ")}}function Yn(o,e){if(o&1){let t=f();r(0,"button",44),_("click",function(){let i=p(t).$implicit,s=c(2);return u(s.changeStatus(i.id))}),r(1,"mat-icon"),m(2),a(),r(3,"span"),m(4),a()()}if(o&2){let t=e.$implicit,n=c();h("disabled",t.id===n.status),l(),B("color",t.color),l(),y(t.icon),l(2),y(t.labelHe)}}function Qn(o,e){if(o&1){let t=f();r(0,"textarea",47),E("ngModelChange",function(i){p(t);let s=c(3);return b(s.editingDescription,i)||(s.editingDescription=i),u(i)}),_("blur",function(){p(t);let i=c(3);return u(i.saveDescription())}),a()}if(o&2){let t=c(3);D("ngModel",t.editingDescription)}}function Xn(o,e){if(o&1){let t=f();r(0,"p",48),_("click",function(){p(t);let i=c(3);return u(i.startDescriptionEdit())}),m(1),a()}if(o&2){let t=c(2);l(),k(" ",t.description||"\u05DC\u05D7\u05E5 \u05DC\u05D4\u05D5\u05E1\u05E4\u05EA \u05EA\u05D9\u05D0\u05D5\u05E8..."," ")}}function Zn(o,e){if(o&1&&(r(0,"section",26),C(1,Qn,1,1,"textarea",45)(2,Xn,2,1,"p",46),a()),o&2){let t=c(2);l(),g(t.isEditingDescription()?1:2)}}function ti(o,e){if(o&1&&(r(0,"span",49),S(1,"span",50),m(2),a()),o&2){let t=e.$implicit;l(),B("background",t.color),l(),k(" ",t.name," ")}}function ei(o,e){if(o&1&&(r(0,"div",27),T(1,ti,3,3,"span",49,jt),a()),o&2){let t=c(2);l(),M(t.linkedChildren())}}function ni(o,e){if(o&1&&(r(0,"div",28)(1,"div",51),S(2,"div",52),a(),r(3,"span",53),m(4),Tt(5,"number"),a()()),o&2){let t=c(2);l(2),B("width",t.progressPercent(),"%"),l(2),k("",Mt(5,3,t.progressPercent(),"1.0-0"),"% \u05D4\u05D5\u05E9\u05DC\u05DD")}}function ii(o,e){if(o&1){let t=f();r(0,"app-content-section",55),_("sectionChange",function(i){p(t);let s=c(3);return u(s.updateSection(i))})("delete",function(){let i=p(t).$implicit,s=c(3);return u(s.deleteSection(i.id))}),a()}if(o&2){let t=e.$implicit;h("section",t)}}function oi(o,e){if(o&1&&(r(0,"div",32),T(1,ii,1,1,"app-content-section",54,jt),a()),o&2){let t=c();l(),M(t.contentSections)}}function ri(o,e){o&1&&(r(0,"div",33)(1,"mat-icon"),m(2,"article"),a(),r(3,"p"),m(4,"\u05D0\u05D9\u05DF \u05EA\u05D5\u05DB\u05DF \u05E2\u05D3\u05D9\u05D9\u05DF. \u05D4\u05D5\u05E1\u05D9\u05E4\u05D5 \u05E7\u05D8\u05E2\u05D9\u05DD \u05D1\u05D0\u05DE\u05E6\u05E2\u05D5\u05EA \u05D4\u05DB\u05E4\u05EA\u05D5\u05E8 \u05DC\u05DE\u05E2\u05DC\u05D4."),a()())}function ai(o,e){if(o&1&&(r(0,"span",39)(1,"mat-icon"),m(2,"event"),a(),m(3),a()),o&2){let t=c();l(3),k(" ",t.linkedEventIds.length," \u05D0\u05D9\u05E8\u05D5\u05E2\u05D9\u05DD ")}}function si(o,e){if(o&1){let t=f();r(0,"header",8)(1,"button",9)(2,"mat-icon"),m(3,"arrow_forward"),a()(),r(4,"div",10)(5,"div",11)(6,"div",12)(7,"mat-icon"),m(8),a()(),C(9,qn,2,1,"input",13)(10,Gn,3,2,"h1",14),a(),r(11,"div",15),S(12,"app-status-badge",16),r(13,"span",17)(14,"mat-icon"),m(15),a(),m(16),a(),C(17,Jn,4,3,"span",18),C(18,Kn,4,2,"span",19),a()(),r(19,"div",20)(20,"button",21)(21,"mat-icon"),m(22,"swap_horiz"),a()(),r(23,"mat-menu",null,0),T(25,Yn,5,5,"button",22,jt),a(),r(27,"button",23)(28,"mat-icon"),m(29,"more_vert"),a()(),r(30,"mat-menu",null,1)(32,"button",24),_("click",function(){p(t);let i=c();return u(i.openEditDialog())}),r(33,"mat-icon"),m(34,"edit"),a(),r(35,"span"),m(36,"\u05E2\u05E8\u05D5\u05DA \u05E4\u05E8\u05D8\u05D9\u05DD"),a()(),r(37,"button",24),_("click",function(){p(t);let i=c();return u(i.togglePin())}),r(38,"mat-icon"),m(39),a(),r(40,"span"),m(41),a()(),r(42,"button",25),_("click",function(){p(t);let i=c();return u(i.deleteTopic())}),r(43,"mat-icon"),m(44,"delete"),a(),r(45,"span"),m(46,"\u05DE\u05D7\u05E7 \u05E0\u05D5\u05E9\u05D0"),a()()()()(),C(47,Zn,3,1,"section",26),C(48,ei,3,0,"div",27),C(49,ni,6,6,"div",28),r(50,"div",29)(51,"div",30)(52,"h2"),m(53,"\u05EA\u05D5\u05DB\u05DF"),a(),r(54,"button",31)(55,"mat-icon"),m(56,"add"),a(),m(57," \u05D4\u05D5\u05E1\u05E3 \u05E7\u05D8\u05E2 "),a(),r(58,"mat-menu",null,2)(60,"button",24),_("click",function(){p(t);let i=c();return u(i.addSection("text"))}),r(61,"mat-icon"),m(62,"notes"),a(),r(63,"span"),m(64,"\u05D8\u05E7\u05E1\u05D8"),a()(),r(65,"button",24),_("click",function(){p(t);let i=c();return u(i.addSection("checklist"))}),r(66,"mat-icon"),m(67,"checklist"),a(),r(68,"span"),m(69,"\u05E8\u05E9\u05D9\u05DE\u05EA \u05DE\u05E9\u05D9\u05DE\u05D5\u05EA"),a()(),r(70,"button",24),_("click",function(){p(t);let i=c();return u(i.addSection("links"))}),r(71,"mat-icon"),m(72,"link"),a(),r(73,"span"),m(74,"\u05E7\u05D9\u05E9\u05D5\u05E8\u05D9\u05DD"),a()()()(),C(75,oi,3,0,"div",32)(76,ri,5,0,"div",33),a(),r(77,"section",34),S(78,"app-task-list",35),a(),r(79,"section",36)(80,"h3",37)(81,"mat-icon"),m(82,"chat"),a(),m(83),a(),S(84,"app-comment-thread",35),a(),r(85,"footer",38)(86,"span",39)(87,"mat-icon"),m(88,"chat_bubble"),a(),m(89),a(),r(90,"span",39)(91,"mat-icon"),m(92,"attach_file"),a(),m(93),a(),C(94,ai,4,1,"span",39),a()}if(o&2){let t=e,n=O(24),i=O(31),s=O(59),d=c();l(6),B("--category-color",d.getCategoryMeta(t.category).color),l(2),y(d.getCategoryMeta(t.category).icon),l(),g(d.isEditingTitle()?9:10),l(3),h("status",t.status),l(),B("color",d.getPriorityMeta(t.priority).color),l(2),y(d.getPriorityMeta(t.priority).icon),l(),k(" ",d.getPriorityMeta(t.priority).labelHe," "),l(),g(t.targetDate?17:-1),l(),g(t.taskCount>0?18:-1),l(2),h("matMenuTriggerFor",n),l(5),M(d.statuses),l(2),h("matMenuTriggerFor",i),l(12),y((t.isPinned,"push_pin")),l(2),y(t.isPinned?"\u05D1\u05D8\u05DC \u05E0\u05E2\u05D9\u05E6\u05D4":"\u05E0\u05E2\u05E5 \u05DC\u05DE\u05E2\u05DC\u05D4"),l(6),g(t.description||d.isEditingDescription()?47:-1),l(),g(d.linkedChildren().length>0?48:-1),l(),g(t.taskCount>0?49:-1),l(5),h("matMenuTriggerFor",s),l(21),g(t.contentSections.length>0?75:76),l(3),h("topicId",t.id),l(5),k(" \u05D3\u05D9\u05D5\u05DF (",t.commentCount,") "),l(),h("topicId",t.id),l(5),k(" ",t.commentCount," \u05EA\u05D2\u05D5\u05D1\u05D5\u05EA "),l(4),k(" ",t.attachmentCount," \u05E7\u05D1\u05E6\u05D9\u05DD "),l(),g(t.linkedEventIds.length>0?94:-1)}}function ci(o,e){o&1&&(r(0,"div",6)(1,"mat-icon"),m(2,"search_off"),a(),r(3,"h2"),m(4,"\u05D4\u05E0\u05D5\u05E9\u05D0 \u05DC\u05D0 \u05E0\u05DE\u05E6\u05D0"),a(),r(5,"button",56),m(6," \u05D7\u05D6\u05E8\u05D4 \u05DC\u05E8\u05E9\u05D9\u05DE\u05D4 "),a()())}var Te=class o{topicsService=v(se);tasksService=v(rt);commentsService=v(_t);familyService=v(N);route=v(qt);router=v(Ht);dialog=v(Ft);snackBar=v(pt);statuses=re;priorities=It;topic=this.topicsService.currentTopic;isEditingTitle=w(!1);isEditingDescription=w(!1);editingTitle="";editingDescription="";linkedChildren=w([]);progressPercent=w(0);ngOnInit(){let e=this.route.snapshot.paramMap.get("topicId");e&&(this.topicsService.subscribeToTopic(e),this.tasksService.subscribeToTasks(e),this.commentsService.subscribeToComments(e),this.updateLinkedChildren())}ngOnDestroy(){this.topicsService.clearCurrentTopic(),this.tasksService.clearTasks(),this.commentsService.clearComments()}updateLinkedChildren(){let e=this.topic();if(e){let t=this.familyService.children();this.linkedChildren.set(t.filter(n=>e.linkedChildrenIds.includes(n.id))),this.progressPercent.set(e.taskCount>0?e.completedTaskCount/e.taskCount*100:0)}}getCategoryMeta=ae;getPriorityMeta=Vt;isOverdue(e){return e.targetDate?e.targetDate.toDate()<new Date&&e.status!=="completed":!1}formatDate(e){return e.toLocaleDateString("he-IL",{day:"numeric",month:"short",year:"numeric"})}startTitleEdit(){let e=this.topic();e&&(this.editingTitle=e.title,this.isEditingTitle.set(!0))}saveTitle(){return x(this,null,function*(){let e=this.topic();if(e&&this.editingTitle.trim()&&this.editingTitle.trim()!==e.title)try{yield this.topicsService.updateTopic(e.id,{title:this.editingTitle.trim()})}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}this.isEditingTitle.set(!1)})}cancelTitleEdit(){this.isEditingTitle.set(!1)}startDescriptionEdit(){let e=this.topic();e&&(this.editingDescription=e.description,this.isEditingDescription.set(!0))}saveDescription(){return x(this,null,function*(){let e=this.topic();if(e&&this.editingDescription!==e.description)try{yield this.topicsService.updateTopic(e.id,{description:this.editingDescription})}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}this.isEditingDescription.set(!1)})}changeStatus(e){return x(this,null,function*(){let t=this.topic();if(t)try{yield this.topicsService.changeStatus(t.id,e),this.snackBar.open("\u05D4\u05E1\u05D8\u05D8\u05D5\u05E1 \u05E2\u05D5\u05D3\u05DB\u05DF","",{duration:2e3})}catch(n){this.snackBar.open(n.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}togglePin(){return x(this,null,function*(){let e=this.topic();if(e)try{yield this.topicsService.togglePin(e.id)}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}openEditDialog(){let e=this.topic();if(!e)return;this.dialog.open(fe,{width:"100%",maxWidth:"500px",data:{topic:e}}).afterClosed().subscribe(n=>{n&&this.snackBar.open("\u05D4\u05E0\u05D5\u05E9\u05D0 \u05E2\u05D5\u05D3\u05DB\u05DF","",{duration:2e3})})}deleteTopic(){return x(this,null,function*(){let e=this.topic();if(e)try{yield this.topicsService.deleteTopic(e.id),this.router.navigate(["/app/topics"]),this.snackBar.open("\u05D4\u05E0\u05D5\u05E9\u05D0 \u05E0\u05DE\u05D7\u05E7","",{duration:2e3})}catch(t){this.snackBar.open(t.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}addSection(e){return x(this,null,function*(){let t=this.topic();if(!t)return;let n=V(V(V({id:crypto.randomUUID(),type:e,title:"",order:t.contentSections.length,isCollapsed:!1},e==="text"&&{content:""}),e==="checklist"&&{items:[]}),e==="links"&&{links:[]}),i=[...t.contentSections,n];try{yield this.topicsService.updateTopic(t.id,{contentSections:i})}catch(s){this.snackBar.open(s.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}updateSection(e){return x(this,null,function*(){let t=this.topic();if(!t)return;let n=t.contentSections.map(i=>i.id===e.id?e:i);try{yield this.topicsService.updateTopic(t.id,{contentSections:n})}catch(i){this.snackBar.open(i.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}deleteSection(e){return x(this,null,function*(){let t=this.topic();if(!t)return;let n=t.contentSections.filter(i=>i.id!==e);try{yield this.topicsService.updateTopic(t.id,{contentSections:n})}catch(i){this.snackBar.open(i.message||"\u05E9\u05D2\u05D9\u05D0\u05D4","\u05E1\u05D2\u05D5\u05E8",{duration:3e3})}})}static \u0275fac=function(t){return new(t||o)};static \u0275cmp=A({type:o,selectors:[["app-topic-detail"]],decls:4,vars:1,consts:[["statusMenu","matMenu"],["actionsMenu","matMenu"],["addSectionMenu","matMenu"],["titleInput",""],[1,"topic-detail-page"],[1,"loading-container"],[1,"not-found"],["diameter","40"],[1,"page-header"],["mat-icon-button","","routerLink","/app/topics",1,"back-btn"],[1,"header-content"],[1,"title-row"],[1,"category-icon"],[1,"title-input",3,"ngModel"],[1,"title"],[1,"meta-row"],[3,"status"],[1,"priority"],[1,"target-date",3,"overdue"],[1,"task-progress"],[1,"header-actions"],["mat-icon-button","","matTooltip","\u05E9\u05E0\u05D4 \u05E1\u05D8\u05D8\u05D5\u05E1",3,"matMenuTriggerFor"],["mat-menu-item","",3,"disabled"],["mat-icon-button","","matTooltip","\u05E4\u05E2\u05D5\u05DC\u05D5\u05EA \u05E0\u05D5\u05E1\u05E4\u05D5\u05EA",3,"matMenuTriggerFor"],["mat-menu-item","",3,"click"],["mat-menu-item","",1,"delete-item",3,"click"],[1,"description-section"],[1,"children-chips"],[1,"progress-section"],[1,"content-sections"],[1,"sections-header"],["mat-stroked-button","",3,"matMenuTriggerFor"],[1,"sections-list"],[1,"empty-sections"],[1,"tasks-section"],[3,"topicId"],[1,"comments-section"],[1,"section-header"],[1,"stats-footer"],[1,"stat"],[1,"title-input",3,"ngModelChange","blur","keydown.enter","keydown.escape","ngModel"],[1,"title",3,"click"],["matTooltip","\u05E0\u05E2\u05D5\u05E5",1,"pin-icon"],[1,"target-date"],["mat-menu-item","",3,"click","disabled"],["placeholder","\u05EA\u05D9\u05D0\u05D5\u05E8 \u05D4\u05E0\u05D5\u05E9\u05D0...","rows","3",1,"description-input",3,"ngModel"],[1,"description"],["placeholder","\u05EA\u05D9\u05D0\u05D5\u05E8 \u05D4\u05E0\u05D5\u05E9\u05D0...","rows","3",1,"description-input",3,"ngModelChange","blur","ngModel"],[1,"description",3,"click"],[1,"child-chip"],[1,"chip-dot"],[1,"progress-bar"],[1,"progress"],[1,"progress-text"],[3,"section"],[3,"sectionChange","delete","section"],["mat-flat-button","","color","primary","routerLink","/app/topics"]],template:function(t,n){if(t&1&&(r(0,"div",4),C(1,Un,4,0,"div",5)(2,si,95,26)(3,ci,7,0,"div",6),a()),t&2){let i;l(),g(n.topicsService.isLoading()?1:(i=n.topic())?2:3,i)}},dependencies:[$,H,j,U,q,Jt,Gt,R,tt,Y,W,z,X,Q,Lt,ot,nt,et,it,Ce,Ot,mt,Pt,St,ut,lt,ct,ge,Bt,Nt,Rt,Dt],styles:[".topic-detail-page[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1.5rem}.loading-container[_ngcontent-%COMP%], .not-found[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;padding:3rem;gap:1rem;text-align:center}.loading-container[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .not-found[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:var(--text-tertiary)}.loading-container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .loading-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], .not-found[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], .not-found[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:var(--text-secondary);margin:0}.page-header[_ngcontent-%COMP%]{display:flex;align-items:flex-start;gap:1rem}.back-btn[_ngcontent-%COMP%]{flex-shrink:0}.header-content[_ngcontent-%COMP%]{flex:1;min-width:0}.title-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.75rem}.category-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:48px;height:48px;border-radius:.75rem;background:color-mix(in srgb,var(--category-color) 15%,transparent);flex-shrink:0}.category-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:var(--category-color);font-size:28px;width:28px;height:28px}.title[_ngcontent-%COMP%]{margin:0;font-size:1.5rem;font-weight:700;color:var(--text-primary);cursor:pointer;display:flex;align-items:center;gap:.5rem}.title[_ngcontent-%COMP%]:hover{color:var(--color-primary)}.title[_ngcontent-%COMP%]   .pin-icon[_ngcontent-%COMP%]{font-size:20px;width:20px;height:20px;color:var(--color-primary)}.title-input[_ngcontent-%COMP%]{flex:1;font-size:1.5rem;font-weight:700;padding:.25rem .5rem;border:2px solid var(--color-primary);border-radius:.5rem;outline:none;background:var(--surface-primary);color:var(--text-primary)}.meta-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-top:.5rem;flex-wrap:wrap}.priority[_ngcontent-%COMP%], .target-date[_ngcontent-%COMP%], .task-progress[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;font-size:.875rem;font-weight:500}.priority[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .target-date[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%], .task-progress[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.target-date[_ngcontent-%COMP%]{color:var(--text-secondary)}.target-date.overdue[_ngcontent-%COMP%]{color:var(--color-error)}.task-progress[_ngcontent-%COMP%]{color:var(--color-success)}.header-actions[_ngcontent-%COMP%]{display:flex;gap:.25rem;flex-shrink:0}.description-section[_ngcontent-%COMP%]{padding:1rem;background:var(--surface-secondary);border-radius:.75rem}.description[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary);line-height:1.6;cursor:pointer;white-space:pre-wrap}.description[_ngcontent-%COMP%]:hover{color:var(--text-primary)}.description-input[_ngcontent-%COMP%]{width:100%;padding:.5rem;border:1px solid var(--color-primary);border-radius:.5rem;font-family:inherit;font-size:.9375rem;line-height:1.6;resize:vertical;background:var(--surface-primary);color:var(--text-primary);outline:none}.children-chips[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:.5rem}.child-chip[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.5rem;padding:.5rem .75rem;background:var(--surface-secondary);border-radius:9999px;font-size:.875rem}.child-chip[_ngcontent-%COMP%]   .chip-dot[_ngcontent-%COMP%]{width:10px;height:10px;border-radius:50%}.progress-section[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem}.progress-bar[_ngcontent-%COMP%]{flex:1;height:8px;background:var(--surface-tertiary);border-radius:4px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]   .progress[_ngcontent-%COMP%]{height:100%;background:var(--color-success);transition:width .3s ease;border-radius:4px}.progress-text[_ngcontent-%COMP%]{font-size:.875rem;font-weight:500;color:var(--color-success)}.content-sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.sections-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.sections-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:1.125rem;font-weight:600}.sections-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}.empty-sections[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;padding:2rem;background:var(--surface-secondary);border-radius:.75rem;text-align:center;gap:.5rem}.empty-sections[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:var(--text-tertiary)}.empty-sections[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;color:var(--text-secondary)}.stats-footer[_ngcontent-%COMP%]{display:flex;gap:1.5rem;padding-top:1rem;border-top:1px solid var(--border-subtle)}.stat[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:.25rem;font-size:.875rem;color:var(--text-secondary)}.stat[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:18px;width:18px;height:18px}.tasks-section[_ngcontent-%COMP%], .comments-section[_ngcontent-%COMP%]{padding:1rem;background:var(--surface-secondary);border-radius:.75rem}.section-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:.5rem;margin:0 0 1rem;font-size:1.125rem;font-weight:600;color:var(--text-primary)}.section-header[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:22px;width:22px;height:22px;color:var(--text-secondary)}.delete-item[_ngcontent-%COMP%]{color:var(--color-error)}"]})};export{Te as TopicDetailComponent};
